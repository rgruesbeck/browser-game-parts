{"version":3,"sources":["../../node_modules/audio-context/index.js","../../node_modules/audio-loader/lib/base64.js","../../node_modules/is-buffer/index.js","../../node_modules/audio-loader/lib/load.js","../../node_modules/audio-loader/lib/browser.js","../../node_modules/webfontloader/webfontloader.js","../../node_modules/game-asset-loader/utils.js","../../node_modules/game-asset-loader/placeholders.js","../../node_modules/game-asset-loader/index.js","utils.js","baseUtils.js","grid.js","../../node_modules/is-audio-buffer/index.js","../../node_modules/audio-play/browser.js","spriteUtils.js","sprite.js","imageSprite.js","block.js","piece.js","main.js","index.js","../../node_modules/parcel-bundler/src/builtins/hmr-runtime.js"],"names":["createBase64Image","dataUri","map","uri","image","Image","src","reduce","img","blankImage","defaultImage","loadList","list","progress","i","percent","loaded","length","then","asset","Math","floor","type","key","Promise","all","assets","collection","value","collectionIncludes","Object","keys","includes","loadImage","url","opts","resolve","reject","optional","params","Error","crossOrigin","filter","join","onload","decode","catch","err","console","warn","path","onerror","loadSound","result","sound","audioCtx","createBuffer","loadFont","fontName","fallback","WebFont","load","google","families","fontactive","familyName","fontinactive","randomBetween","min","max","rand","random","round","bounded","n","isBounded","hexToRgbA","hex","opacity","h","replace","match","RegExp","parseInt","push","throttled","delay","fn","lastCall","now","Date","getTime","findInList","entList","find","ent","findInObject","entObject","entries","findIn","entities","Array","isArray","hashCode","str","base","split","a","b","charCodeAt","num","abs","toString","resizeByWidth","width","naturalWidth","naturalHeight","height","resizeByHeight","resize","error","getDistance","pointA","pointB","vx","x","vy","y","sqrt","pickFromList","index","getMaxFromList","item","getMinFromList","getCursorPosition","canvas","event","rect","getBoundingClientRect","clientX","left","clientY","top","gridCell","grid","cell","gridCol","gridRow","setGridCell","neighborLeft","neighborRight","neighborDown","getCellSize","rows","cols","sizeByWidth","sizeByHeight","inBox","box","inX","right","inY","bottom","padBounds","bounds","pickLocation","pickLocationAwayFrom","point","distance","depth","maxDepth","location","locationDistance","pickLocationAwayFromList","hasCloseNeighbor","dist","Sprite","speed","direction","px","py","cx","cy","radius","setBounds","m","dx","dy","setX","setY","nx","ny","ImageSprite","options","ctx","save","scaleX","xPosition","trX","translate","scale","drawImage","restore","Block","size","color","fillStyle","fillRect","Piece","board","shape","cellSize","cellBounds","preplaceTick","placed","body","createBody","center","columns","shift","forEach","block","draw","listY","listX","hitLeft","hitRight","getBox","origin","rotateCellAround","idx","arr","prev","bar","leftL","rightL","leftS","rightS","tee","selectShape","requestAnimationFrame","window","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","cancelAnimationFrame","mozCancelAnimationFrame","Game","root","config","prefix","settings","name","log","document","createElement","appendChild","getContext","playlist","addEventListener","code","handleKeyboardInput","touches","handleTouchMove","handleSwipe","frame","count","time","rate","clientHeight","clientWidth","screen","centerX","centerY","state","current","tickRate","score","paused","muted","localStorage","getItem","concat","input","active","keyboard","up","down","mouse","click","swipe","touch","blocks","lastClear","tickQueue","bag","pieces","stack","cleared","images","sounds","fonts","style","backgroundColor","colors","backgroundMusic","pause","init","gameAssets","block1","block2","block3","block4","block5","block6","spectatorLeft","spectatorRight","clearSound","dropSound","fontFamily","create","blockStyles","setState","play","boardColor","playback","start","end","duration","loop","context","topRow","queuedTick","sort","priority","tick","pop","run","placedBlocks","piece","p","s","scheduledTick","queueTick","shiftPieceDown","rowCounts","fullRows","unsupported","shiftStackDown","sprite","move","requestFrame","updatePieces","hitBottom","hasDownNeighbor","some","hasLeftNeighbor","hasRightNeighbor","rotatedCells","id","blockingCells","onEdge","offX","offY","rotate","maxShift","stackCells","minShift","stackPairs","sc","minPair","minP","sp","row","target","mute","reset","modeInfinity","infinityAction","rotatePiece","shiftPieceLeft","shiftPieceRight","dropPiece","lastTap","diff","swipesX","swipesY","overlay","setPause","cancelFrame","suspend","setBanner","resume","hide","setItem","setMute","audioBuffer","slice","targetBuffer","stopPlayback","next","resumed","getElementById","game","OVERLAY_ID","OldModule","module","bundle","Module","moduleName","call","hot","data","hotData","_acceptCallbacks","_disposeCallbacks","accept","dispose","checkedAssets","assetsToAccept","parent","isParcelRequire","WebSocket","hostname","protocol","ws","onmessage","JSON","parse","handled","isNew","didAccept","hmrAcceptCheck","global","parcelRequire","every","generated","js","clear","hmrApply","v","hmrAcceptRun","reload","close","onclose","removeErrorOverlay","message","createErrorOverlay","remove","stackTrace","innerText","innerHTML","getParents","modules","parents","k","d","dep","Function","deps","cached","cache","cb"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AC5CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACrBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACpJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACjBA;AACA,MAAMA,iBAAiB,GAAIC,OAAD,IAAa;AACnC,SAAO,CAACA,OAAD,EACNC,GADM,CACFC,GAAG,IAAI;AACR,QAAIC,KAAK,GAAG,IAAIC,KAAJ,EAAZ;AACAD,IAAAA,KAAK,CAACE,GAAN,GAAYH,GAAZ;AACA,WAAOC,KAAP;AACH,GALM,EAKJG,MALI,CAKGC,GAAG,IAAIA,GALV,CAAP;AAMH,CAPD;;;;;;;;;;;ACDA;;;;;;;AASA;AACA;AACA;AACA;AACA,MAAMC,UAAU,GAAI,oHAApB,EAEA;AACA;;;AACA,MAAMC,YAAY,GAAI;;;;;;;;;aAAtB;;;;;;;;;;ACXA;;AACA;;AACA;;AAEA;;AACA;;;;AAXA;;;;;AAaA,MAAMC,QAAQ,GAAG,CAACC,IAAD,EAAOC,QAAP,KAAoB;AACjC;AACA,MAAIC,CAAC,GAAG,CAAR;AACAD,EAAAA,QAAQ,CAAC;AAAEE,IAAAA,OAAO,EAAE,CAAX;AAAcC,IAAAA,MAAM,EAAE;AAAtB,GAAD,CAAR;;AACA,OAAK,IAAIF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,IAAI,CAACK,MAAzB,EAAiCH,CAAC,IAAI,CAAtC,EAAyC;AACrCF,IAAAA,IAAI,CAACE,CAAD,CAAJ,CAAQI,IAAR,CAAcC,KAAD,IAAW;AACpBL,MAAAA,CAAC;AACDD,MAAAA,QAAQ,CAAC;AACLE,QAAAA,OAAO,EAAEK,IAAI,CAACC,KAAL,CAAWP,CAAC,GAAG,GAAJ,GAAUF,IAAI,CAACK,MAA1B,CADJ;AAELD,QAAAA,MAAM,EAAE;AAAEM,UAAAA,IAAI,EAAEH,KAAK,CAACG,IAAd;AAAoBC,UAAAA,GAAG,EAAEJ,KAAK,CAACI;AAA/B;AAFH,OAAD,CAAR;AAIH,KAND;AAOH;;AAED,SAAOC,OAAO,CAACC,GAAR,CAAYb,IAAZ,EACFM,IADE,CACIQ,MAAD,IAAY;AACd,WAAOA,MAAM,CAACnB,MAAP,CAAc,CAACoB,UAAD,EAAaR,KAAb,KAAuB;AACxC;AACA;AAEA,YAAM;AAAEG,QAAAA,IAAF;AAAQC,QAAAA,GAAR;AAAaK,QAAAA;AAAb,UAAuBT,KAA7B;AAEA,YAAMU,kBAAkB,GAAGC,MAAM,CAACC,IAAP,CAAYJ,UAAZ,EAAwBK,QAAxB,CAAiCV,IAAjC,CAA3B;;AACA,UAAI,CAACO,kBAAL,EAAyB;AAAEF,QAAAA,UAAU,CAACL,IAAD,CAAV,GAAmB,EAAnB;AAAuB;;AAElDK,MAAAA,UAAU,CAACL,IAAD,CAAV,CAAiBC,GAAjB,IAAwBK,KAAxB;AACA,aAAOD,UAAP;AACH,KAXM,EAWJ,EAXI,CAAP;AAYH,GAdE,CAAP;AAeH,CA7BD;;;;AA+BA,MAAMM,SAAS,GAAG,CAACV,GAAD,EAAMW,GAAN,EAAWC,IAAI,GAAG,EAAlB,KAAyB;AACvC,SAAO,IAAIX,OAAJ,CAAY,CAACY,OAAD,EAAUC,MAAV,KAAqB;AACpC,QAAI;AAAEC,MAAAA,QAAF;AAAYC,MAAAA;AAAZ,QAAuBJ,IAA3B,CADoC,CAGpC;;AACA,QAAI,CAACZ,GAAL,EAAU;AAAEc,MAAAA,MAAM,CAAC,IAAIG,KAAJ,CAAU,cAAV,CAAD,CAAN;AAAmC;;AAE/C,QAAIpC,KAAK,GAAG,IAAIC,KAAJ,EAAZ;AACAD,IAAAA,KAAK,CAACqC,WAAN,GAAoB,WAApB;AACArC,IAAAA,KAAK,CAACE,GAAN,GAAY,CAAC4B,GAAD,EAAMK,MAAN,EAAcG,MAAd,CAAqB5B,CAAC,IAAIA,CAA1B,EAA6B6B,IAA7B,CAAkC,GAAlC,CAAZ,CARoC,CAUpC;;AACAvC,IAAAA,KAAK,CAACwC,MAAN,GAAe,MAAM;AACjB;AACA;AACA,UAAIxC,KAAK,CAACyC,MAAV,EAAkB;AACdzC,QAAAA,KAAK,CAACyC,MAAN,GACC3B,IADD,CACM,MAAM;AACRkB,UAAAA,OAAO,CAAC;AACJd,YAAAA,IAAI,EAAE,OADF;AAEJC,YAAAA,GAAG,EAAEA,GAFD;AAGJK,YAAAA,KAAK,EAAExB;AAHH,WAAD,CAAP;AAKH,SAPD,EAQC0C,KARD,CAQQC,GAAD,IAAS;AACZ;AACAC,UAAAA,OAAO,CAACC,IAAR,CAAc,wCAAuC1B,GAAI,WAAUW,GAAI,IAAvE,EAA4Ea,GAAG,CAACG,IAAhF,EAAuF,yBAAvF;AACAd,UAAAA,OAAO,CAAC;AACJd,YAAAA,IAAI,EAAE,OADF;AAEJC,YAAAA,GAAG,EAAEA,GAFD;AAGJK,YAAAA,KAAK,EAAEU,QAAQ,IAAIJ,GAAG,KAAK,EAApB,GACP,8BAAkBzB,wBAAlB,CADO,GAEP,8BAAkBC,0BAAlB;AALI,WAAD,CAAP;AAOH,SAlBD;AAmBH,OApBD,MAoBO;AACH0B,QAAAA,OAAO,CAAC;AACJd,UAAAA,IAAI,EAAE,OADF;AAEJC,UAAAA,GAAG,EAAEA,GAFD;AAGJK,UAAAA,KAAK,EAAExB;AAHH,SAAD,CAAP;AAKH;AACJ,KA9BD,CAXoC,CA2CpC;;;AACAA,IAAAA,KAAK,CAAC+C,OAAN,GAAiBJ,GAAD,IAAS;AACrB,UAAI,CAACT,QAAL,EAAe;AACXU,QAAAA,OAAO,CAACC,IAAR,CAAc,kCAAiC1B,GAAI,WAAUW,GAAI,IAAjE,EAAsEa,GAAG,CAACG,IAA1E,EAAiF,yBAAjF;AACH;;AAEDd,MAAAA,OAAO,CAAC;AACJd,QAAAA,IAAI,EAAE,OADF;AAEJC,QAAAA,GAAG,EAAEA,GAFD;AAGJK,QAAAA,KAAK,EAAEU,QAAQ,IAAIJ,GAAG,KAAK,EAApB,GACP,8BAAkBzB,wBAAlB,CADO,GAEP,8BAAkBC,0BAAlB;AALI,OAAD,CAAP;AAOH,KAZD;AAaH,GAzDM,CAAP;AA2DH,CA5DD;;;;AA8DA,MAAM0C,SAAS,GAAG,CAAC7B,GAAD,EAAMW,GAAN,KAAc;AAC5B,MAAImB,MAAM,GAAG;AAAE/B,IAAAA,IAAI,EAAE,OAAR;AAAiBC,IAAAA,GAAG,EAAEA,GAAtB;AAA2BK,IAAAA,KAAK,EAAE;AAAlC,GAAb;AAEA,SAAO,IAAIJ,OAAJ,CAAY,CAACY,OAAD,EAAUC,MAAV,KAAqB;AACpC;AACA,QAAI,CAACd,GAAL,EAAU;AAAEc,MAAAA,MAAM,CAAC,IAAIG,KAAJ,CAAU,cAAV,CAAD,CAAN;AAAmC;;AAE/C,8BAAkBN,GAAlB,EACKhB,IADL,CACWoC,KAAD,IAAW;AACblB,MAAAA,OAAO,CAAC;AACJd,QAAAA,IAAI,EAAE,OADF;AAEJC,QAAAA,GAAG,EAAEA,GAFD;AAGJK,QAAAA,KAAK,EAAE0B;AAHH,OAAD,CAAP;AAKH,KAPL,EAQKR,KARL,CAQYC,GAAD,IAAS;AACZ;AACA;AACA;AACA;AACAC,MAAAA,OAAO,CAACC,IAAR,CAAc,kCAAiC1B,GAAI,WAAUW,GAAI,IAAjE,EAAsEa,GAAtE,EAA4E,yBAA5E;AAEA,YAAMQ,QAAQ,GAAG,4BAAjB;AACAnB,MAAAA,OAAO,CAAC;AACJd,QAAAA,IAAI,EAAE,OADF;AAEJC,QAAAA,GAAG,EAAEA,GAFD;AAGJK,QAAAA,KAAK,EAAE2B,QAAQ,CAACC,YAAT,CAAsB,CAAtB,EAAyB,CAAzB,EAA4B,KAA5B;AAHH,OAAD,CAAP;AAMH,KAtBL;AAuBH,GA3BM,CAAP;AA4BH,CA/BD;;;;AAiCA,MAAMC,QAAQ,GAAG,CAAClC,GAAD,EAAMmC,QAAN,EAAgBvB,IAAI,GAAG,EAAvB,KAA8B;AAC3C,SAAO,IAAIX,OAAJ,CAAY,CAACY,OAAD,EAAUC,MAAV,KAAqB;AACpC,QAAI;AAAEsB,MAAAA;AAAF,QAAexB,IAAnB,CADoC,CAGpC;;AACA,QAAI,CAACZ,GAAL,EAAU;AAAEc,MAAAA,MAAM,CAAC,IAAIG,KAAJ,CAAU,cAAV,CAAD,CAAN;AAAmC;;AAE/C,QAAI,CAACkB,QAAL,EAAe;AAAEtB,MAAAA,OAAO,CAAC;AACrBd,QAAAA,IAAI,EAAE,MADe;AAErBC,QAAAA,GAAG,EAAEA,GAFgB;AAGrBK,QAAAA,KAAK,EAAE+B,QAAQ,IAAI;AAHE,OAAD,CAAP;AAId;;AAEHC,2BAAQC,IAAR,CAAa;AACTC,MAAAA,MAAM,EAAE;AACJC,QAAAA,QAAQ,EAAE,CAACL,QAAD;AADN,OADC;AAITM,MAAAA,UAAU,EAAEC,UAAU,IAAI;AACtB7B,QAAAA,OAAO,CAAC;AACJd,UAAAA,IAAI,EAAE,MADF;AAEJC,UAAAA,GAAG,EAAEA,GAFD;AAGJK,UAAAA,KAAK,EAAEqC;AAHH,SAAD,CAAP;AAKH,OAVQ;AAWTC,MAAAA,YAAY,EAAE,MAAM;AAChB9B,QAAAA,OAAO,CAAC;AACJd,UAAAA,IAAI,EAAE,MADF;AAEJC,UAAAA,GAAG,EAAEA,GAFD;AAGJK,UAAAA,KAAK,EAAE+B,QAAQ,IAAI;AAHf,SAAD,CAAP;AAKH;AAjBQ,KAAb;AAmBH,GA/BM,CAAP;AAgCH,CAjCD;;;;;;;;;;;;;;;;;AC3IA;AACA,IAAMQ,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAMC,GAAN,EAAW/C,IAAX,EAAoB;AACtC,MAAMgD,IAAI,GAAGlD,IAAI,CAACmD,MAAL,MAAiBF,GAAG,GAAGD,GAAvB,IAA8BA,GAA3C;;AAEA,MAAI9C,IAAI,IAAIA,IAAI,KAAK,KAArB,EAA4B;AACxB,WAAOF,IAAI,CAACoD,KAAL,CAAWF,IAAX,CAAP;AACH;;AAED,SAAOA,IAAP;AACH,CARD,EAUA;;;;;AACA,IAAMG,OAAO,GAAG,SAAVA,OAAU,CAACC,CAAD,EAAIN,GAAJ,EAASC,GAAT,EAAiB;AAC7B,SAAO,CAACK,CAAD,EACNxE,GADM,CACF,UAAAwE,CAAC;AAAA,WAAIA,CAAC,GAAGN,GAAJ,GAAUA,GAAV,GAAgBM,CAApB;AAAA,GADC,EAENxE,GAFM,CAEF,UAAAwE,CAAC;AAAA,WAAIA,CAAC,GAAGL,GAAJ,GAAUA,GAAV,GAAgBK,CAApB;AAAA,GAFC,EAGNnE,MAHM,CAGC,UAAAmE,CAAC;AAAA,WAAIA,CAAJ;AAAA,GAHF,CAAP;AAIH,CALD,EAOA;;;;;AACA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACD,CAAD,EAAIN,GAAJ,EAASC,GAAT,EAAiB;AAC/B,SAAOK,CAAC,GAAGN,GAAJ,IAAWM,CAAC,GAAGL,GAAtB;AACH,CAFD,EAIA;;;;;AACA,IAAMO,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAMC,OAAN,EAAkB;AAChC,MAAIC,CAAC,GAACF,GAAG,CAACG,OAAJ,CAAY,GAAZ,EAAiB,EAAjB,CAAN;AACAD,EAAAA,CAAC,GAAIA,CAAC,CAACE,KAAF,CAAQ,IAAIC,MAAJ,CAAW,QAAMH,CAAC,CAAC9D,MAAF,GAAS,CAAf,GAAiB,IAA5B,EAAkC,GAAlC,CAAR,CAAL;;AAEA,OAAI,IAAIH,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACiE,CAAC,CAAC9D,MAAjB,EAAyBH,CAAC,EAA1B;AACIiE,IAAAA,CAAC,CAACjE,CAAD,CAAD,GAAOqE,QAAQ,CAACJ,CAAC,CAACjE,CAAD,CAAD,CAAKG,MAAL,IAAa,CAAb,GAAgB8D,CAAC,CAACjE,CAAD,CAAD,GAAKiE,CAAC,CAACjE,CAAD,CAAtB,GAA0BiE,CAAC,CAACjE,CAAD,CAA5B,EAAiC,EAAjC,CAAf;AADJ;;AAGA,MAAI,OAAOgE,OAAP,IAAkB,WAAtB,EAAoCC,CAAC,CAACK,IAAF,CAAON,OAAP;AAEpC,SAAO,UAAQC,CAAC,CAACpC,IAAF,CAAO,GAAP,CAAR,GAAoB,GAA3B;AACH,CAVD,EAYA;AACA;;;;;AACA,IAAM0C,SAAS,GAAG,SAAZA,SAAY,CAACC,KAAD,EAAQC,EAAR,EAAe;AAC7B,MAAIC,QAAQ,GAAG,CAAf;AACA,SAAO,YAAmB;AACtB,QAAMC,GAAG,GAAI,IAAIC,IAAJ,EAAD,CAAWC,OAAX,EAAZ;;AACA,QAAIF,GAAG,GAAGD,QAAN,GAAiBF,KAArB,EAA4B;AACxB;AACH;;AACDE,IAAAA,QAAQ,GAAGC,GAAX;AACA,WAAOF,EAAE,MAAF,mBAAP;AACH,GAPD;AAQH,CAVD,EAYA;AACA;;;;;AACA,IAAMK,UAAU,GAAG,SAAbA,UAAa,CAACC,OAAD,EAAUN,EAAV,EAAiB;AAChC,SAAOM,OAAO,CACTC,IADE,CACG,UAACC,GAAD,EAAS;AACX,WAAOR,EAAE,CAACQ,GAAD,CAAT;AACH,GAHE,IAIH,IAJG,GAII,KAJX;AAKH,CAND,EAQA;AACA;;;AACA,IAAMC,YAAY,GAAG,SAAfA,YAAe,CAACC,SAAD,EAAYV,EAAZ,EAAmB;AACpC,SAAOzD,MAAM,CAACoE,OAAP,CAAeD,SAAf,EACFH,IADE,CACG,UAACC,GAAD,EAAS;AACX,WAAOR,EAAE,CAACQ,GAAD,CAAT;AACH,GAHE,IAIH,IAJG,GAII,KAJX;AAKH,CAND,EAQA;AACA;;;AACA,IAAMI,MAAM,GAAG,SAATA,MAAS,CAACC,QAAD,EAAWb,EAAX,EAAkB;AAE7B;AACA,MAAIc,KAAK,CAACC,OAAN,CAAcF,QAAd,CAAJ,EAA6B;AACzB,WAAOR,UAAU,CAACQ,QAAD,EAAWb,EAAX,CAAjB;AACH,GAL4B,CAO7B;;;AACA,MAAIzD,MAAM,CAACC,IAAP,CAAYqE,QAAZ,IAAwB,CAA5B,EAA+B;AAC3B,WAAOJ,YAAY,CAACI,QAAD,EAAWb,EAAX,CAAnB;AACH;;AAED,SAAO,KAAP;AACH,CAbD,EAeA;AACA;;;;;AACA,IAAMgB,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD,EAAoB;AAAA,MAAdC,IAAc,uEAAP,EAAO;AACjC,SAAO,CAACD,GAAG,CAACE,KAAJ,CAAU,EAAV,EACPnG,MADO,CACA,UAASoG,CAAT,EAAYC,CAAZ,EAAe;AACrBD,IAAAA,CAAC,GAAI,CAACA,CAAC,IAAI,CAAN,IAAWA,CAAZ,GAAiBC,CAAC,CAACC,UAAF,CAAa,CAAb,CAArB;AACA,WAAOF,CAAC,GAAGA,CAAX;AACD,GAJO,EAIL,CAJK,CAAD,EAIA;AAJA,GAKNzG,GALM,CAKF,UAAA4G,GAAG;AAAA,WAAI1F,IAAI,CAAC2F,GAAL,CAASD,GAAT,CAAJ;AAAA,GALD,EAKoB;AALpB,GAMN5G,GANM,CAMF,UAAA4G,GAAG;AAAA,WAAIA,GAAG,CAACE,QAAJ,CAAaP,IAAb,CAAJ;AAAA,GAND,EAMyB;AANzB,GAONlG,MAPM,CAOC,UAAAwE,CAAC;AAAA,WAAIA,CAAJ;AAAA,GAPF,CAAP,CADiC,CAQhB;AACpB,CATD,EAWA;;;;;AACA,IAAMkC,aAAa,GAAG,SAAhBA,aAAgB,CAACC,KAAD,EAAQC,YAAR,EAAsBC,aAAtB,EAAwC;AAC1D;AACA,SAAO;AACHF,IAAAA,KAAK,EAAE/B,QAAQ,CAAC+B,KAAD,CADZ;AAEHG,IAAAA,MAAM,EAAElC,QAAQ,CAAC+B,KAAK,GAAGE,aAAR,GAAwBD,YAAzB;AAFb,GAAP;AAIH,CAND,EAQA;;;AACA,IAAMG,cAAc,GAAG,SAAjBA,cAAiB,CAACD,MAAD,EAASF,YAAT,EAAuBC,aAAvB,EAAyC;AAC5D;AACA,SAAO;AACHC,IAAAA,MAAM,EAAElC,QAAQ,CAACkC,MAAD,CADb;AAEHH,IAAAA,KAAK,EAAE/B,QAAQ,CAACkC,MAAM,GAAGF,YAAT,GAAwBC,aAAzB;AAFZ,GAAP;AAIH,CAND,EAQA;;;AACA,IAAMG,MAAM,GAAG,SAATA,MAAS,OAA8B;AAAA,MAA3BnH,KAA2B,QAA3BA,KAA2B;AAAA,MAApB8G,KAAoB,QAApBA,KAAoB;AAAA,MAAbG,MAAa,QAAbA,MAAa;;AACzC;AACA,MAAI,CAACjH,KAAL,EAAY;AACR4C,IAAAA,OAAO,CAACwE,KAAR,CAAc,0BAAd;AACA;AACH,GALwC,CAOzC;;;AACA,MAAI,CAACN,KAAD,IAAU,CAACG,MAAf,EAAuB;AACnBrE,IAAAA,OAAO,CAACwE,KAAR,CAAc,mCAAd;AACA;AACH,GAXwC,CAazC;;;AACA,MAAIN,KAAK,IAAIG,MAAb,EAAqB;AACjB,WAAO;AAAEH,MAAAA,KAAK,EAAEA,KAAT;AAAgBG,MAAAA,MAAM,EAAEA;AAAxB,KAAP;AACH,GAhBwC,CAkBzC;;;AACA,MAAIF,YAAY,GAAG/G,KAAK,CAAC8G,KAAzB;AACA,MAAIE,aAAa,GAAGhH,KAAK,CAACiH,MAA1B;AACA,MAAIhE,MAAM,GAAG,EAAb,CArByC,CAuBzC;;AACA,MAAI6D,KAAJ,EAAW;AACP7D,IAAAA,MAAM,qBACCA,MADD,MAEC4D,aAAa,CAACC,KAAD,EAAQC,YAAR,EAAsBC,aAAtB,CAFd,CAAN;AAIH,GA7BwC,CA+BzC;;;AACA,MAAIC,MAAJ,EAAY;AACRhE,IAAAA,MAAM,qBACCA,MADD,MAECiE,cAAc,CAACD,MAAD,EAASF,YAAT,EAAuBC,aAAvB,CAFf,CAAN;AAIH;;AAED,SAAO/D,MAAP;AACH,CAxCD;;;;;;;;;;;ACxHA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA,IAAMc,aAAa,GAAG,SAAhBA,aAAgB,CAACC,GAAD,EAAMC,GAAN,EAAW/C,IAAX,EAAoB;AACtC,MAAMgD,IAAI,GAAGlD,IAAI,CAACmD,MAAL,MAAiBF,GAAG,GAAGD,GAAvB,IAA8BA,GAA3C;;AAEA,MAAI9C,IAAI,IAAIA,IAAI,KAAK,KAArB,EAA4B;AACxB,WAAOF,IAAI,CAACoD,KAAL,CAAWF,IAAX,CAAP;AACH;;AAED,SAAOA,IAAP;AACH,CARD,EAUA;;;;;AACA,IAAMmD,WAAW,GAAG,SAAdA,WAAc,CAACC,MAAD,EAASC,MAAT,EAAoB;AACpC,MAAIC,EAAE,GAAGF,MAAM,CAACG,CAAP,GAAWF,MAAM,CAACE,CAA3B;AACA,MAAIC,EAAE,GAAGJ,MAAM,CAACK,CAAP,GAAWJ,MAAM,CAACI,CAA3B;AAEA,SAAO3G,IAAI,CAAC4G,IAAL,CAAUJ,EAAE,GAAGA,EAAL,GAAUE,EAAE,GAAGA,EAAzB,CAAP;AACH,CALD,EAOA;;;;;AACA,IAAMG,YAAY,GAAG,SAAfA,YAAe,CAACrH,IAAD,EAAU;AAC3B,MAAI,CAACyF,KAAK,CAACC,OAAN,CAAc1F,IAAd,CAAD,IAAwBA,IAAI,CAACK,MAAL,GAAc,CAA1C,EAA6C;AAAE;AAAS;;AAExD,MAAIiH,KAAK,GAAG/D,aAAa,CAAC,CAAD,EAAIvD,IAAI,CAACK,MAAL,GAAc,CAAlB,EAAqB,KAArB,CAAzB;AACA,SAAOL,IAAI,CAACsH,KAAD,CAAX;AACH,CALD,EAOA;;;;;AACA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACvH,IAAD,EAAU;AAC7B,SAAOA,IAAI,CACVL,MADM,CACC,UAAC8D,GAAD,EAAM+D,IAAN,EAAe;AACnB,WAAOhH,IAAI,CAACiD,GAAL,CAASA,GAAT,EAAc+D,IAAd,CAAP;AACH,GAHM,EAGJ,CAHI,CAAP;AAIH,CALD,EAOA;;;;;AACA,IAAMC,cAAc,GAAG,SAAjBA,cAAiB,CAACzH,IAAD,EAAU;AAC7B,SAAOA,IAAI,CACVL,MADM,CACC,UAAC6D,GAAD,EAAMgE,IAAN,EAAe;AACnB,WAAOhH,IAAI,CAACgD,GAAL,CAASA,GAAT,EAAcgE,IAAd,CAAP;AACH,GAHM,EAGJxH,IAAI,CAAC,CAAD,CAAJ,GAAU,CAHN,CAAP;AAIH,CALD,EAOA;;;;;AACA,IAAM6D,OAAO,GAAG,SAAVA,OAAU,CAACC,CAAD,EAAIN,GAAJ,EAASC,GAAT,EAAiB;AAC7B,SAAO,CAACK,CAAD,EACNxE,GADM,CACF,UAAAwE,CAAC;AAAA,WAAIA,CAAC,GAAGN,GAAJ,GAAUA,GAAV,GAAgBM,CAApB;AAAA,GADC,EAENxE,GAFM,CAEF,UAAAwE,CAAC;AAAA,WAAIA,CAAC,GAAGL,GAAJ,GAAUA,GAAV,GAAgBK,CAApB;AAAA,GAFC,EAGNnE,MAHM,CAGC,UAAAmE,CAAC;AAAA,WAAIA,CAAJ;AAAA,GAHF,CAAP;AAIH,CALD,EAOA;;;;;AACA,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAACD,CAAD,EAAIN,GAAJ,EAASC,GAAT,EAAiB;AAC/B,SAAOK,CAAC,GAAGN,GAAJ,IAAWM,CAAC,GAAGL,GAAtB;AACH,CAFD,EAIA;AACA;;;;;AACA,IAAMiE,iBAAiB,GAAG,SAApBA,iBAAoB,CAACC,MAAD,EAASC,KAAT,EAAmB;AACzC,MAAMC,IAAI,GAAGF,MAAM,CAACG,qBAAP,EAAb;AACA,SAAO;AACHb,IAAAA,CAAC,EAAEW,KAAK,CAACG,OAAN,GAAgBF,IAAI,CAACG,IADrB;AAEHb,IAAAA,CAAC,EAAES,KAAK,CAACK,OAAN,GAAgBJ,IAAI,CAACK;AAFrB,GAAP;AAIH,CAND,EAQA;;;;;AACA,IAAMlE,SAAS,GAAG,SAAZA,SAAY,CAACC,GAAD,EAAMC,OAAN,EAAkB;AAChC,MAAIC,CAAC,GAACF,GAAG,CAACG,OAAJ,CAAY,GAAZ,EAAiB,EAAjB,CAAN;AACAD,EAAAA,CAAC,GAAIA,CAAC,CAACE,KAAF,CAAQ,IAAIC,MAAJ,CAAW,QAAMH,CAAC,CAAC9D,MAAF,GAAS,CAAf,GAAiB,IAA5B,EAAkC,GAAlC,CAAR,CAAL;;AAEA,OAAI,IAAIH,CAAC,GAAC,CAAV,EAAaA,CAAC,GAACiE,CAAC,CAAC9D,MAAjB,EAAyBH,CAAC,EAA1B;AACIiE,IAAAA,CAAC,CAACjE,CAAD,CAAD,GAAOqE,QAAQ,CAACJ,CAAC,CAACjE,CAAD,CAAD,CAAKG,MAAL,IAAa,CAAb,GAAgB8D,CAAC,CAACjE,CAAD,CAAD,GAAKiE,CAAC,CAACjE,CAAD,CAAtB,GAA0BiE,CAAC,CAACjE,CAAD,CAA5B,EAAiC,EAAjC,CAAf;AADJ;;AAGA,MAAI,OAAOgE,OAAP,IAAkB,WAAtB,EAAoCC,CAAC,CAACK,IAAF,CAAON,OAAP;AAEpC,SAAO,UAAQC,CAAC,CAACpC,IAAF,CAAO,GAAP,CAAR,GAAoB,GAA3B;AACH,CAVD,EAYA;AACA;;;;;AACA,IAAM0C,SAAS,GAAG,SAAZA,SAAY,CAACC,KAAD,EAAQC,EAAR,EAAe;AAC7B,MAAIC,QAAQ,GAAG,CAAf;AACA,SAAO,YAAmB;AACtB,QAAMC,GAAG,GAAI,IAAIC,IAAJ,EAAD,CAAWC,OAAX,EAAZ;;AACA,QAAIF,GAAG,GAAGD,QAAN,GAAiBF,KAArB,EAA4B;AACxB;AACH;;AACDE,IAAAA,QAAQ,GAAGC,GAAX;AACA,WAAOF,EAAE,MAAF,mBAAP;AACH,GAPD;AAQH,CAVD,EAYA;AACA;;;;;AACA,IAAMgB,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD,EAAoB;AAAA,MAAdC,IAAc,uEAAP,EAAO;AACjC,SAAO,CAACD,GAAG,CAACE,KAAJ,CAAU,EAAV,EACPnG,MADO,CACA,UAASoG,CAAT,EAAYC,CAAZ,EAAe;AACrBD,IAAAA,CAAC,GAAI,CAACA,CAAC,IAAI,CAAN,IAAWA,CAAZ,GAAiBC,CAAC,CAACC,UAAF,CAAa,CAAb,CAArB;AACA,WAAOF,CAAC,GAAGA,CAAX;AACD,GAJO,EAIL,CAJK,CAAD,EAIA;AAJA,GAKNzG,GALM,CAKF,UAAA4G,GAAG;AAAA,WAAI1F,IAAI,CAAC2F,GAAL,CAASD,GAAT,CAAJ;AAAA,GALD,EAKoB;AALpB,GAMN5G,GANM,CAMF,UAAA4G,GAAG;AAAA,WAAIA,GAAG,CAACE,QAAJ,CAAaP,IAAb,CAAJ;AAAA,GAND,EAMyB;AANzB,GAONlG,MAPM,CAOC,UAAAwE,CAAC;AAAA,WAAIA,CAAJ;AAAA,GAPF,CAAP,CADiC,CAQhB;AACpB,CATD;;;;;;;;;;;AC9HA,IAAMgE,QAAQ,GAAG,SAAXA,QAAW,CAACC,IAAD,EAAOnB,CAAP,EAAUE,CAAV,EAAgB;AAC7B,MAAIkB,IAAI,GAAID,IAAI,IAChBA,IAAI,CAACnB,CAAD,CADQ,IAEZmB,IAAI,CAACnB,CAAD,CAAJ,CAAQE,CAAR,CAFA;AAIA,SAAOkB,IAAI,IAAI,KAAf;AACH,CAND;;;;AAQA,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAACF,IAAD,EAAOnB,CAAP,EAAa;AACzB,SAAOmB,IAAI,IAAIA,IAAI,CAACnB,CAAD,CAAnB;AACH,CAFD;;;;AAIA,IAAMsB,OAAO,GAAG,SAAVA,OAAU,CAACH,IAAD,EAAOjB,CAAP,EAAa;AACzB,SAAOiB,IAAI,IAAIA,IAAI,CAClBtG,MADc,CACP,UAAAmF,CAAC;AAAA,WAAIA,CAAC,IAAIA,CAAC,CAACE,CAAD,CAAV;AAAA,GADM,EAEd7H,GAFc,CAEV,UAAA2H,CAAC;AAAA,WAAIA,CAAC,CAACE,CAAD,CAAL;AAAA,GAFS,CAAf;AAGH,CAJD;;;;AAMA,IAAMqB,WAAW,GAAG,SAAdA,WAAc,CAACJ,IAAD,EAAOC,IAAP,EAAarH,KAAb,EAAuB;AAAA,MACjCiG,CADiC,GACxBoB,IADwB,CACjCpB,CADiC;AAAA,MAC9BE,CAD8B,GACxBkB,IADwB,CAC9BlB,CAD8B,EAGvC;;AACA,MAAI,OAAOiB,IAAI,CAACnB,CAAD,CAAX,KAAmB,WAAvB,EAAoC;AAAEmB,IAAAA,IAAI,CAACnB,CAAD,CAAJ,GAAU,EAAV;AAAe;;AACrD,MAAI,OAAOmB,IAAI,CAACnB,CAAD,CAAJ,CAAQE,CAAR,CAAP,KAAsB,WAA1B,EAAuC;AAAEiB,IAAAA,IAAI,CAACnB,CAAD,CAAJ,CAAQE,CAAR,IAAa,KAAb;AAAqB,GALvB,CAOvC;;;AACAiB,EAAAA,IAAI,CAACnB,CAAD,CAAJ,CAAQE,CAAR,IAAanG,KAAb;AAEA,SAAOoH,IAAP;AACH,CAXD;;;;AAaA,IAAMK,YAAY,GAAG,SAAfA,YAAe,CAACL,IAAD,EAAOC,IAAP,EAAgB;AACjC,SAAOF,QAAQ,CAACC,IAAD,EAAOC,IAAI,CAACpB,CAAL,GAAS,CAAhB,EAAmBoB,IAAI,CAAClB,CAAxB,CAAf;AACH,CAFD;;;;AAIA,IAAMuB,aAAa,GAAG,SAAhBA,aAAgB,CAACN,IAAD,EAAOC,IAAP,EAAgB;AAClC,SAAOF,QAAQ,CAACC,IAAD,EAAOC,IAAI,CAACpB,CAAL,GAAS,CAAhB,EAAmBoB,IAAI,CAAClB,CAAxB,CAAf;AACH,CAFD;;;;AAIA,IAAMwB,YAAY,GAAG,SAAfA,YAAe,CAACP,IAAD,EAAOC,IAAP,EAAgB;AACjC,SAAOF,QAAQ,CAACC,IAAD,EAAOC,IAAI,CAACpB,CAAZ,EAAeoB,IAAI,CAAClB,CAAL,GAAS,CAAxB,CAAf;AACH,CAFD;;;;AAIA,IAAMyB,WAAW,GAAG,SAAdA,WAAc,CAACtC,KAAD,EAAQG,MAAR,EAAgBoC,IAAhB,EAAsBC,IAAtB,EAA+B;AAC/C,MAAIC,WAAW,GAAGvI,IAAI,CAACoD,KAAL,CAAW0C,KAAK,GAAGwC,IAAnB,CAAlB;AACA,MAAIE,YAAY,GAAGxI,IAAI,CAACoD,KAAL,CAAW6C,MAAM,GAAGoC,IAApB,CAAnB;AAEA,SAAOrI,IAAI,CAACgD,GAAL,CAASuF,WAAT,EAAsBC,YAAtB,CAAP;AACH,CALD;;;;AC3CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;ACzGA;;AAMA;AACA,IAAMC,KAAK,GAAG,SAARA,KAAQ,CAAChC,CAAD,EAAIE,CAAJ,EAAO+B,GAAP,EAAe;AACzB;AACA,MAAMC,GAAG,GAAG,0BAAUlC,CAAV,EAAaiC,GAAG,CAAClB,IAAjB,EAAuBkB,GAAG,CAACE,KAA3B,CAAZ;AACA,MAAMC,GAAG,GAAG,0BAAUlC,CAAV,EAAa+B,GAAG,CAAChB,GAAjB,EAAsBgB,GAAG,CAACI,MAA1B,CAAZ;AAEA,SAAOH,GAAG,IAAIE,GAAd;AACH,CAND,EAQA;AACA;;;;;AACA,IAAME,SAAS,GAAG,SAAZA,SAAY,CAACC,MAAD,EAASvC,CAAT,EAAYE,CAAZ,EAAkB;AAChC,SAAO;AACHe,IAAAA,GAAG,EAAEsB,MAAM,CAACtB,GAAP,GAAaf,CADf;AAEHiC,IAAAA,KAAK,EAAEI,MAAM,CAACJ,KAAP,GAAenC,CAFnB;AAGHqC,IAAAA,MAAM,EAAEE,MAAM,CAACF,MAAP,GAAgBnC,CAHrB;AA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","file":"tetris.e31bb0bc.js","sourceRoot":"..","sourcesContent":["'use strict'\r\n\r\nvar cache = {}\r\n\r\nmodule.exports = function getContext (options) {\r\n\tif (typeof window === 'undefined') return null\r\n\t\r\n\tvar OfflineContext = window.OfflineAudioContext || window.webkitOfflineAudioContext\r\n\tvar Context = window.AudioContext || window.webkitAudioContext\r\n\t\r\n\tif (!Context) return null\r\n\r\n\tif (typeof options === 'number') {\r\n\t\toptions = {sampleRate: options}\r\n\t}\r\n\r\n\tvar sampleRate = options && options.sampleRate\r\n\r\n\r\n\tif (options && options.offline) {\r\n\t\tif (!OfflineContext) return null\r\n\r\n\t\treturn new OfflineContext(options.channels || 2, options.length, sampleRate || 44100)\r\n\t}\r\n\r\n\r\n\t//cache by sampleRate, rather strong guess\r\n\tvar ctx = cache[sampleRate]\r\n\r\n\tif (ctx) return ctx\r\n\r\n\t//several versions of firefox have issues with the\r\n\t//constructor argument\r\n\t//see: https://bugzilla.mozilla.org/show_bug.cgi?id=1361475\r\n\ttry {\r\n\t\tctx = new Context(options)\r\n\t}\r\n\tcatch (err) {\r\n\t\tctx = new Context()\r\n\t}\r\n\tcache[ctx.sampleRate] = cache[sampleRate] = ctx\r\n\r\n\treturn ctx\r\n}\r\n","'use strict'\r\n\r\n// DECODE UTILITIES\r\nfunction b64ToUint6 (nChr) {\r\n  return nChr > 64 && nChr < 91 ? nChr - 65\r\n    : nChr > 96 && nChr < 123 ? nChr - 71\r\n    : nChr > 47 && nChr < 58 ? nChr + 4\r\n    : nChr === 43 ? 62\r\n    : nChr === 47 ? 63\r\n    : 0\r\n}\r\n\r\n// Decode Base64 to Uint8Array\r\n// ---------------------------\r\nfunction decode (sBase64, nBlocksSize) {\r\n  var sB64Enc = sBase64.replace(/[^A-Za-z0-9\\+\\/]/g, '')\r\n  var nInLen = sB64Enc.length\r\n  var nOutLen = nBlocksSize\r\n    ? Math.ceil((nInLen * 3 + 1 >> 2) / nBlocksSize) * nBlocksSize\r\n    : nInLen * 3 + 1 >> 2\r\n  var taBytes = new Uint8Array(nOutLen)\r\n\r\n  for (var nMod3, nMod4, nUint24 = 0, nOutIdx = 0, nInIdx = 0; nInIdx < nInLen; nInIdx++) {\r\n    nMod4 = nInIdx & 3\r\n    nUint24 |= b64ToUint6(sB64Enc.charCodeAt(nInIdx)) << 18 - 6 * nMod4\r\n    if (nMod4 === 3 || nInLen - nInIdx === 1) {\r\n      for (nMod3 = 0; nMod3 < 3 && nOutIdx < nOutLen; nMod3++, nOutIdx++) {\r\n        taBytes[nOutIdx] = nUint24 >>> (16 >>> nMod3 & 24) & 255\r\n      }\r\n      nUint24 = 0\r\n    }\r\n  }\r\n  return taBytes\r\n}\r\n\r\nmodule.exports = { decode: decode }\r\n","/*!\n * Determine if an object is a Buffer\n *\n * @author   Feross Aboukhadijeh <https://feross.org>\n * @license  MIT\n */\n\n// The _isBuffer check is for Safari 5-7 support, because it's missing\n// Object.prototype.constructor. Remove this eventually\nmodule.exports = function (obj) {\n  return obj != null && (isBuffer(obj) || isSlowBuffer(obj) || !!obj._isBuffer)\n}\n\nfunction isBuffer (obj) {\n  return !!obj.constructor && typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n}\n\n// For Node v0.10 support. Remove this eventually.\nfunction isSlowBuffer (obj) {\n  return typeof obj.readFloatLE === 'function' && typeof obj.slice === 'function' && isBuffer(obj.slice(0, 0))\n}\n","'use strict'\r\n\r\nvar base64 = require('./base64')\r\nvar isBuffer = require('is-buffer')\r\n\r\n// Given a regex, return a function that test if against a string\r\nfunction fromRegex (r) {\r\n  return function (o) { return typeof o === 'string' && r.test(o) }\r\n}\r\n// Try to apply a prefix to a name\r\nfunction prefix (pre, name) {\r\n  return typeof pre === 'string' ? pre + name\r\n    : typeof pre === 'function' ? pre(name)\r\n    : name\r\n}\r\n\r\n/**\r\n * Load one or more audio files\r\n *\r\n *\r\n * Possible option keys:\r\n *\r\n * - __from__ {Function|String}: a function or string to convert from file names to urls.\r\n * If is a string it will be prefixed to the name:\r\n * `load('snare.mp3', { from: 'http://audio.net/samples/' })`\r\n * If it's a function it receives the file name and should return the url as string.\r\n * - __only__ {Array} - when loading objects, if provided, only the given keys\r\n * will be included in the decoded object:\r\n * `load('piano.json', { only: ['C2', 'D2'] })`\r\n *\r\n * @param {Object} source - the object to be loaded\r\n * @param {Object} options - (Optional) the load options for that object\r\n * @param {Object} defaultValue - (Optional) the default value to return as\r\n * in a promise if not valid loader found\r\n */\r\nfunction load (source, options, defVal) {\r\n  var loader =\r\n    // Basic audio loading\r\n      isArrayBuffer(source) || isBuffer(source) ? decodeBuffer\r\n    : isAudioFileName(source) ? loadAudioFile\r\n    : isPromise(source) ? loadPromise\r\n    // Compound objects\r\n    : isArray(source) ? loadArrayData\r\n    : isObject(source) ? loadObjectData\r\n    : isJsonFileName(source) ? loadJsonFile\r\n    // Base64 encoded audio\r\n    : isBase64Audio(source) ? loadBase64Audio\r\n    : isJsFileName(source) ? loadMidiJSFile\r\n    : null\r\n\r\n  var opts = options || {}\r\n  var promise = loader ? loader(source, opts)\r\n    : defVal ? Promise.resolve(defVal)\r\n    : Promise.reject('Source not valid (' + source + ')')\r\n\r\n  return promise.then(function (data) {\r\n    opts.ready(null, data)\r\n    return data\r\n  }, function (err) {\r\n    opts.ready(err)\r\n    throw err\r\n  })\r\n}\r\n\r\n// BASIC AUDIO LOADING\r\n// ===================\r\n\r\n// Load (decode) an array buffer\r\nfunction isArrayBuffer (o) { return o instanceof ArrayBuffer }\r\nfunction decodeBuffer (array, options) {\r\n  return options.decode(array)\r\n}\r\n\r\n// Load an audio filename\r\nvar isAudioFileName = fromRegex(/\\.(mp3|wav|ogg)(\\?.*)?$/i)\r\nfunction loadAudioFile (name, options) {\r\n  var url = prefix(options.from, name)\r\n  return load(options.fetch(url, 'arraybuffer'), options)\r\n}\r\n\r\n// Load the result of a promise\r\nfunction isPromise (o) { return o && typeof o.then === 'function' }\r\nfunction loadPromise (promise, options) {\r\n  return promise.then(function (value) {\r\n    return load(value, options)\r\n  })\r\n}\r\n\r\n// COMPOUND OBJECTS\r\n// ================\r\n\r\n// Try to load all the items of an array\r\nvar isArray = Array.isArray\r\nfunction loadArrayData (array, options) {\r\n  return Promise.all(array.map(function (data) {\r\n    return load(data, options, data)\r\n  }))\r\n}\r\n\r\n// Try to load all the values of a key/value object\r\nfunction isObject (o) { return o && typeof o === 'object' }\r\nfunction loadObjectData (obj, options) {\r\n  var dest = {}\r\n  var promises = Object.keys(obj).map(function (key) {\r\n    if (options.only && options.only.indexOf(key) === -1) return null\r\n    var value = obj[key]\r\n    return load(value, options, value).then(function (audio) {\r\n      dest[key] = audio\r\n    })\r\n  })\r\n  return Promise.all(promises).then(function () { return dest })\r\n}\r\n\r\n// Load the content of a JSON file\r\nvar isJsonFileName = fromRegex(/\\.json(\\?.*)?$/i)\r\nfunction loadJsonFile (name, options) {\r\n  var url = prefix(options.from, name)\r\n  return load(options.fetch(url, 'text').then(JSON.parse), options)\r\n}\r\n\r\n// BASE64 ENCODED FORMATS\r\n// ======================\r\n\r\n// Load strings with Base64 encoded audio\r\nvar isBase64Audio = fromRegex(/^data:audio/)\r\nfunction loadBase64Audio (source, options) {\r\n  var i = source.indexOf(',')\r\n  return load(base64.decode(source.slice(i + 1)).buffer, options)\r\n}\r\n\r\n// Load .js files with MidiJS soundfont prerendered audio\r\nvar isJsFileName = fromRegex(/\\.js(\\?.*)?$/i)\r\nfunction loadMidiJSFile (name, options) {\r\n  var url = prefix(options.from, name)\r\n  return load(options.fetch(url, 'text').then(midiJsToJson), options)\r\n}\r\n\r\n// convert a MIDI.js javascript soundfont file to json\r\nfunction midiJsToJson (data) {\r\n  var begin = data.indexOf('MIDI.Soundfont.')\r\n  if (begin < 0) throw Error('Invalid MIDI.js Soundfont format')\r\n  begin = data.indexOf('=', begin) + 2\r\n  var end = data.lastIndexOf(',')\r\n  return JSON.parse(data.slice(begin, end) + '}')\r\n}\r\n\r\nif (typeof module === 'object' && module.exports) module.exports = load\r\nif (typeof window !== 'undefined') window.loadAudio = load\r\n","/* global XMLHttpRequest */\r\n'use strict'\r\nvar load = require('./load')\r\nvar context = require('audio-context')\r\n\r\nmodule.exports = function (source, options, cb) {\r\n  if (options instanceof Function) {\r\n    cb = options\r\n    options = {}\r\n  }\r\n  options = options || {}\r\n  options.ready = cb || function () {}\r\n  var ac = options && options.context ? options.context : context()\r\n  var defaults = { decode: getAudioDecoder(ac), fetch: fetch }\r\n  var opts = Object.assign(defaults, options)\r\n  return load(source, opts)\r\n}\r\n\r\n/**\r\n * Wraps AudioContext's decodeAudio into a Promise\r\n */\r\nfunction getAudioDecoder (ac) {\r\n  return function decode (buffer) {\r\n    return new Promise(function (resolve, reject) {\r\n      ac.decodeAudioData(buffer,\r\n        function (data) { resolve(data) },\r\n        function (err) { reject(err) })\r\n    })\r\n  }\r\n}\r\n\r\n/*\r\n * Wraps a XMLHttpRequest into a Promise\r\n *\r\n * @param {String} url\r\n * @param {String} type - can be 'text' or 'arraybuffer'\r\n * @return {Promise}\r\n */\r\nfunction fetch (url, type) {\r\n  return new Promise(function (resolve, reject) {\r\n    var req = new XMLHttpRequest()\r\n    if (type) req.responseType = type\r\n\r\n    req.open('GET', url)\r\n    req.onload = function () {\r\n      req.status === 200 ? resolve(req.response) : reject(Error(req.statusText))\r\n    }\r\n    req.onerror = function () { reject(Error('Network Error')) }\r\n    req.send()\r\n  })\r\n}\r\n","/* Web Font Loader v1.6.28 - (c) Adobe Systems, Google. License: Apache 2.0 */(function(){function aa(a,b,c){return a.call.apply(a.bind,arguments)}function ba(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,d);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function p(a,b,c){p=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf(\"native code\")?aa:ba;return p.apply(null,arguments)}var q=Date.now||function(){return+new Date};function ca(a,b){this.a=a;this.o=b||a;this.c=this.o.document}var da=!!window.FontFace;function t(a,b,c,d){b=a.c.createElement(b);if(c)for(var e in c)c.hasOwnProperty(e)&&(\"style\"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));d&&b.appendChild(a.c.createTextNode(d));return b}function u(a,b,c){a=a.c.getElementsByTagName(b)[0];a||(a=document.documentElement);a.insertBefore(c,a.lastChild)}function v(a){a.parentNode&&a.parentNode.removeChild(a)}\nfunction w(a,b,c){b=b||[];c=c||[];for(var d=a.className.split(/\\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}b=[];for(e=0;e<d.length;e+=1){f=!1;for(g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(\" \").replace(/\\s+/g,\" \").replace(/^\\s+|\\s+$/,\"\")}function y(a,b){for(var c=a.className.split(/\\s+/),d=0,e=c.length;d<e;d++)if(c[d]==b)return!0;return!1}\nfunction ea(a){return a.o.location.hostname||a.a.location.hostname}function z(a,b,c){function d(){m&&e&&f&&(m(g),m=null)}b=t(a,\"link\",{rel:\"stylesheet\",href:b,media:\"all\"});var e=!1,f=!0,g=null,m=c||null;da?(b.onload=function(){e=!0;d()},b.onerror=function(){e=!0;g=Error(\"Stylesheet failed to load\");d()}):setTimeout(function(){e=!0;d()},0);u(a,\"head\",b)}\nfunction A(a,b,c,d){var e=a.c.getElementsByTagName(\"head\")[0];if(e){var f=t(a,\"script\",{src:b}),g=!1;f.onload=f.onreadystatechange=function(){g||this.readyState&&\"loaded\"!=this.readyState&&\"complete\"!=this.readyState||(g=!0,c&&c(null),f.onload=f.onreadystatechange=null,\"HEAD\"==f.parentNode.tagName&&e.removeChild(f))};e.appendChild(f);setTimeout(function(){g||(g=!0,c&&c(Error(\"Script load timeout\")))},d||5E3);return f}return null};function B(){this.a=0;this.c=null}function C(a){a.a++;return function(){a.a--;D(a)}}function E(a,b){a.c=b;D(a)}function D(a){0==a.a&&a.c&&(a.c(),a.c=null)};function F(a){this.a=a||\"-\"}F.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\\W_]+/g,\"\").toLowerCase());return b.join(this.a)};function G(a,b){this.c=a;this.f=4;this.a=\"n\";var c=(b||\"n4\").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function fa(a){return H(a)+\" \"+(a.f+\"00\")+\" 300px \"+I(a.c)}function I(a){var b=[];a=a.split(/,\\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['\"]/g,\"\");-1!=d.indexOf(\" \")||/^\\d/.test(d)?b.push(\"'\"+d+\"'\"):b.push(d)}return b.join(\",\")}function J(a){return a.a+a.f}function H(a){var b=\"normal\";\"o\"===a.a?b=\"oblique\":\"i\"===a.a&&(b=\"italic\");return b}\nfunction ga(a){var b=4,c=\"n\",d=null;a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10))));return c+b};function ha(a,b){this.c=a;this.f=a.o.document.documentElement;this.h=b;this.a=new F(\"-\");this.j=!1!==b.events;this.g=!1!==b.classes}function ia(a){a.g&&w(a.f,[a.a.c(\"wf\",\"loading\")]);K(a,\"loading\")}function L(a){if(a.g){var b=y(a.f,a.a.c(\"wf\",\"active\")),c=[],d=[a.a.c(\"wf\",\"loading\")];b||c.push(a.a.c(\"wf\",\"inactive\"));w(a.f,c,d)}K(a,\"inactive\")}function K(a,b,c){if(a.j&&a.h[b])if(c)a.h[b](c.c,J(c));else a.h[b]()};function ja(){this.c={}}function ka(a,b,c){var d=[],e;for(e in b)if(b.hasOwnProperty(e)){var f=a.c[e];f&&d.push(f(b[e],c))}return d};function M(a,b){this.c=a;this.f=b;this.a=t(this.c,\"span\",{\"aria-hidden\":\"true\"},this.f)}function N(a){u(a.c,\"body\",a.a)}function O(a){return\"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:\"+I(a.c)+\";\"+(\"font-style:\"+H(a)+\";font-weight:\"+(a.f+\"00\")+\";\")};function P(a,b,c,d,e,f){this.g=a;this.j=b;this.a=d;this.c=c;this.f=e||3E3;this.h=f||void 0}P.prototype.start=function(){var a=this.c.o.document,b=this,c=q(),d=new Promise(function(d,e){function f(){q()-c>=b.f?e():a.fonts.load(fa(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=null,f=new Promise(function(a,d){e=setTimeout(d,b.f)});Promise.race([f,d]).then(function(){e&&(clearTimeout(e),e=null);b.g(b.a)},function(){b.j(b.a)})};function Q(a,b,c,d,e,f,g){this.v=a;this.B=b;this.c=c;this.a=d;this.s=g||\"BESbswy\";this.f={};this.w=e||3E3;this.u=f||null;this.m=this.j=this.h=this.g=null;this.g=new M(this.c,this.s);this.h=new M(this.c,this.s);this.j=new M(this.c,this.s);this.m=new M(this.c,this.s);a=new G(this.a.c+\",serif\",J(this.a));a=O(a);this.g.a.style.cssText=a;a=new G(this.a.c+\",sans-serif\",J(this.a));a=O(a);this.h.a.style.cssText=a;a=new G(\"serif\",J(this.a));a=O(a);this.j.a.style.cssText=a;a=new G(\"sans-serif\",J(this.a));a=\nO(a);this.m.a.style.cssText=a;N(this.g);N(this.h);N(this.j);N(this.m)}var R={D:\"serif\",C:\"sans-serif\"},S=null;function T(){if(null===S){var a=/AppleWebKit\\/([0-9]+)(?:\\.([0-9]+))/.exec(window.navigator.userAgent);S=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return S}Q.prototype.start=function(){this.f.serif=this.j.a.offsetWidth;this.f[\"sans-serif\"]=this.m.a.offsetWidth;this.A=q();U(this)};\nfunction la(a,b,c){for(var d in R)if(R.hasOwnProperty(d)&&b===a.f[R[d]]&&c===a.f[R[d]])return!0;return!1}function U(a){var b=a.g.a.offsetWidth,c=a.h.a.offsetWidth,d;(d=b===a.f.serif&&c===a.f[\"sans-serif\"])||(d=T()&&la(a,b,c));d?q()-a.A>=a.w?T()&&la(a,b,c)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?V(a,a.v):V(a,a.B):ma(a):V(a,a.v)}function ma(a){setTimeout(p(function(){U(this)},a),50)}function V(a,b){setTimeout(p(function(){v(this.g.a);v(this.h.a);v(this.j.a);v(this.m.a);b(this.a)},a),0)};function W(a,b,c){this.c=a;this.a=b;this.f=0;this.m=this.j=!1;this.s=c}var X=null;W.prototype.g=function(a){var b=this.a;b.g&&w(b.f,[b.a.c(\"wf\",a.c,J(a).toString(),\"active\")],[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\"),b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\")]);K(b,\"fontactive\",a);this.m=!0;na(this)};\nW.prototype.h=function(a){var b=this.a;if(b.g){var c=y(b.f,b.a.c(\"wf\",a.c,J(a).toString(),\"active\")),d=[],e=[b.a.c(\"wf\",a.c,J(a).toString(),\"loading\")];c||d.push(b.a.c(\"wf\",a.c,J(a).toString(),\"inactive\"));w(b.f,d,e)}K(b,\"fontinactive\",a);na(this)};function na(a){0==--a.f&&a.j&&(a.m?(a=a.a,a.g&&w(a.f,[a.a.c(\"wf\",\"active\")],[a.a.c(\"wf\",\"loading\"),a.a.c(\"wf\",\"inactive\")]),K(a,\"active\")):L(a.a))};function oa(a){this.j=a;this.a=new ja;this.h=0;this.f=this.g=!0}oa.prototype.load=function(a){this.c=new ca(this.j,a.context||this.j);this.g=!1!==a.events;this.f=!1!==a.classes;pa(this,new ha(this.c,a),a)};\nfunction qa(a,b,c,d,e){var f=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=e||null,m=d||null||{};if(0===c.length&&f)L(b.a);else{b.f+=c.length;f&&(b.j=f);var h,l=[];for(h=0;h<c.length;h++){var k=c[h],n=m[k.c],r=b.a,x=k;r.g&&w(r.f,[r.a.c(\"wf\",x.c,J(x).toString(),\"loading\")]);K(r,\"fontloading\",x);r=null;if(null===X)if(window.FontFace){var x=/Gecko.*Firefox\\/(\\d+)/.exec(window.navigator.userAgent),xa=/OS X.*Version\\/10\\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);\nX=x?42<parseInt(x[1],10):xa?!1:!0}else X=!1;X?r=new P(p(b.g,b),p(b.h,b),b.c,k,b.s,n):r=new Q(p(b.g,b),p(b.h,b),b.c,k,b.s,a,n);l.push(r)}for(h=0;h<l.length;h++)l[h].start()}},0)}function pa(a,b,c){var d=[],e=c.timeout;ia(b);var d=ka(a.a,c,a.c),f=new W(a.c,b,e);a.h=d.length;b=0;for(c=d.length;b<c;b++)d[b].load(function(b,d,c){qa(a,f,b,d,c)})};function ra(a,b){this.c=a;this.a=b}\nra.prototype.load=function(a){function b(){if(f[\"__mti_fntLst\"+d]){var c=f[\"__mti_fntLst\"+d](),e=[],h;if(c)for(var l=0;l<c.length;l++){var k=c[l].fontfamily;void 0!=c[l].fontStyle&&void 0!=c[l].fontWeight?(h=c[l].fontStyle+c[l].fontWeight,e.push(new G(k,h))):e.push(new G(k))}a(e)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.o;A(this.c,(c.a.api||\"https://fast.fonts.net/jsapi\")+\"/\"+d+\".js\"+(e?\"?v=\"+e:\"\"),function(e){e?a([]):(f[\"__MonotypeConfiguration__\"+\nd]=function(){return c.a},b())}).id=\"__MonotypeAPIScript__\"+d}else a([])};function sa(a,b){this.c=a;this.a=b}sa.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new B;b=0;for(c=d.length;b<c;b++)z(this.c,d[b],C(g));var m=[];b=0;for(c=e.length;b<c;b++)if(d=e[b].split(\":\"),d[1])for(var h=d[1].split(\",\"),l=0;l<h.length;l+=1)m.push(new G(d[0],h[l]));else m.push(new G(d[0]));E(g,function(){a(m,f)})};function ta(a,b){a?this.c=a:this.c=ua;this.a=[];this.f=[];this.g=b||\"\"}var ua=\"https://fonts.googleapis.com/css\";function va(a,b){for(var c=b.length,d=0;d<c;d++){var e=b[d].split(\":\");3==e.length&&a.f.push(e.pop());var f=\"\";2==e.length&&\"\"!=e[1]&&(f=\":\");a.a.push(e.join(f))}}\nfunction wa(a){if(0==a.a.length)throw Error(\"No fonts to load!\");if(-1!=a.c.indexOf(\"kit=\"))return a.c;for(var b=a.a.length,c=[],d=0;d<b;d++)c.push(a.a[d].replace(/ /g,\"+\"));b=a.c+\"?family=\"+c.join(\"%7C\");0<a.f.length&&(b+=\"&subset=\"+a.f.join(\",\"));0<a.g.length&&(b+=\"&text=\"+encodeURIComponent(a.g));return b};function ya(a){this.f=a;this.a=[];this.c={}}\nvar za={latin:\"BESbswy\",\"latin-ext\":\"\\u00e7\\u00f6\\u00fc\\u011f\\u015f\",cyrillic:\"\\u0439\\u044f\\u0416\",greek:\"\\u03b1\\u03b2\\u03a3\",khmer:\"\\u1780\\u1781\\u1782\",Hanuman:\"\\u1780\\u1781\\u1782\"},Aa={thin:\"1\",extralight:\"2\",\"extra-light\":\"2\",ultralight:\"2\",\"ultra-light\":\"2\",light:\"3\",regular:\"4\",book:\"4\",medium:\"5\",\"semi-bold\":\"6\",semibold:\"6\",\"demi-bold\":\"6\",demibold:\"6\",bold:\"7\",\"extra-bold\":\"8\",extrabold:\"8\",\"ultra-bold\":\"8\",ultrabold:\"8\",black:\"9\",heavy:\"9\",l:\"3\",r:\"4\",b:\"7\"},Ba={i:\"i\",italic:\"i\",n:\"n\",normal:\"n\"},\nCa=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/;\nfunction Da(a){for(var b=a.f.length,c=0;c<b;c++){var d=a.f[c].split(\":\"),e=d[0].replace(/\\+/g,\" \"),f=[\"n4\"];if(2<=d.length){var g;var m=d[1];g=[];if(m)for(var m=m.split(\",\"),h=m.length,l=0;l<h;l++){var k;k=m[l];if(k.match(/^[\\w-]+$/)){var n=Ca.exec(k.toLowerCase());if(null==n)k=\"\";else{k=n[2];k=null==k||\"\"==k?\"n\":Ba[k];n=n[1];if(null==n||\"\"==n)n=\"4\";else var r=Aa[n],n=r?r:isNaN(n)?\"4\":n.substr(0,1);k=[k,n].join(\"\")}}else k=\"\";k&&g.push(k)}0<g.length&&(f=g);3==d.length&&(d=d[2],g=[],d=d?d.split(\",\"):\ng,0<d.length&&(d=za[d[0]])&&(a.c[e]=d))}a.c[e]||(d=za[e])&&(a.c[e]=d);for(d=0;d<f.length;d+=1)a.a.push(new G(e,f[d]))}};function Ea(a,b){this.c=a;this.a=b}var Fa={Arimo:!0,Cousine:!0,Tinos:!0};Ea.prototype.load=function(a){var b=new B,c=this.c,d=new ta(this.a.api,this.a.text),e=this.a.families;va(d,e);var f=new ya(e);Da(f);z(c,wa(d),C(b));E(b,function(){a(f.a,f.c,Fa)})};function Ga(a,b){this.c=a;this.a=b}Ga.prototype.load=function(a){var b=this.a.id,c=this.c.o;b?A(this.c,(this.a.api||\"https://use.typekit.net\")+\"/\"+b+\".js\",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var e=[],f=0;f<b.length;f+=2)for(var g=b[f],m=b[f+1],h=0;h<m.length;h++)e.push(new G(g,m[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(l){}a(e)}},2E3):a([])};function Ha(a,b){this.c=a;this.f=b;this.a=[]}Ha.prototype.load=function(a){var b=this.f.id,c=this.c.o,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var g=0,m=c.fonts.length;g<m;++g){var h=c.fonts[g];d.a.push(new G(h.name,ga(\"font-weight:\"+h.weight+\";font-style:\"+h.style)))}a(d.a)},A(this.c,(this.f.api||\"https://f.fontdeck.com/s/css/js/\")+ea(this.c)+\"/\"+b+\".js\",function(b){b&&a([])})):a([])};var Y=new oa(window);Y.a.c.custom=function(a,b){return new sa(b,a)};Y.a.c.fontdeck=function(a,b){return new Ha(b,a)};Y.a.c.monotype=function(a,b){return new ra(b,a)};Y.a.c.typekit=function(a,b){return new Ga(b,a)};Y.a.c.google=function(a,b){return new Ea(b,a)};var Z={load:p(Y.load,Y)};\"function\"===typeof define&&define.amd?define(function(){return Z}):\"undefined\"!==typeof module&&module.exports?module.exports=Z:(window.WebFont=Z,window.WebFontConfig&&Y.load(window.WebFontConfig));}());\n","// create image from data uri\nconst createBase64Image = (dataUri) => {\n    return [dataUri]\n    .map(uri => {\n        let image = new Image();\n        image.src = uri;\n        return image;\n    }).reduce(img => img);\n}\n\nexport {\n    createBase64Image\n}","/**\n *   This file contains data uris for use as fallbacks\n * \n *   blankImage: used as an invisible image for optional images, avoids safari restrictions\n *   \n *   defaultImage: placeholder image for unloaded images\n */\n\n\n// 1x1 px transparent png from http://png-pixel.com/\n// blank image used for optional images\n// fixes Safari restriction on drawing unloaded images to canvas\n// https://github.com/konvajs/react-konva/issues/185\nconst blankImage = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=`;\n\n// 32x32 placeholder image from\n// lets developer know image was not loaded\nconst defaultImage = `data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAABGdBTUEAALGPC/xhBQAAAAFzUkdC\nAK7OHOkAAAA8UExURQAAANHR0UJCQmtra5ubm////xISEre3txMTE5ycnLi4uOnp6SYmJt3d3VhY\nWPT09I2Njaqqqn19fcXFxbjmkisAAAFqSURBVFjDpdfbcoQgDAbggE1dDuK6ff93LajbLgpJgMw4\ncPUNJL8XwDxYMM9f39BdCTAjQgIeI0ICYETYgRHhAAaEE+gX3oBQMGpDNHFFXKYckAkGVfz8Eyew\nq84BkWBWgIB62eLemQsgEYwC0KjXZ9wrewUEwglUTiAQTqDcA4lwAsUp0IIyXA4aOkkDrcIdKAvx\nCmgcKr2g0+BVzKObKkBRSIALAdfJrxtYp/2CVaAkJCCmx8Xw/FiPLwBPALvwuAHTER5r0yABKOAu\nZAB/gruQAbEHARQNXIUc2KfAAIU+5BUw0AAlpGEoBwxACGGJP5NmAfYWLCARaEAgMAAvcAArsAAn\n8AAjCABakACkIAIoQQYQghCoC1KgKoiBmiAHKkIDUBZagKLQBJSENqAgNAJ3oRW4Cc3AVWgHLkIH\nkAs9QCZ0AZ9CH/AhdAL/Qi/wJ3QDb6EfOIUB4BBGgCSYISAJY8AuwOjz/xdsEharPg6y9AAAAABJ\nRU5ErkJggg==`;\n\nexport { blankImage, defaultImage };","/**\n * \n *   Asset loading functions\n * \n */\n\nimport audioContext from 'audio-context';\nimport audioBufferLoader from 'audio-loader';\nimport WebFont from 'webfontloader'\n\nimport { createBase64Image } from './utils.js';\nimport { blankImage, defaultImage } from './placeholders.js';\n\nconst loadList = (list, progress) => {\n    // calculate loading progress\n    let i = 0;\n    progress({ percent: 0, loaded: null });\n    for (let i = 0; i < list.length; i += 1) {\n        list[i].then((asset) => {\n            i++;\n            progress({\n                percent: Math.floor(i * 100 / list.length),\n                loaded: { type: asset.type, key: asset.key }\n            })\n        });\n    }\n\n    return Promise.all(list)\n        .then((assets) => {\n            return assets.reduce((collection, asset) => {\n                // separate assets by type\n                // add them to the collection\n\n                const { type, key, value } = asset;\n\n                const collectionIncludes = Object.keys(collection).includes(type);\n                if (!collectionIncludes) { collection[type] = {} }\n\n                collection[type][key] = value;\n                return collection;\n            }, {});\n        })\n}\n\nconst loadImage = (key, url, opts = {}) => {\n    return new Promise((resolve, reject) => {\n        let { optional, params } = opts;\n\n        // reject with error for missing key or url\n        if (!key) { reject(new Error('key required')) }\n\n        let image = new Image;\n        image.crossOrigin = \"Anonymous\";\n        image.src = [url, params].filter(i => i).join('?')\n\n        // loaded\n        image.onload = () => {\n            // pre-decode so decoding will not block main thread\n            // especially for large background images\n            if (image.decode) {\n                image.decode()\n                .then(() => {\n                    resolve({\n                        type: 'image',\n                        key: key,\n                        value: image\n                    });\n                })\n                .catch((err) => {\n                    // decode error\n                    console.warn(`Warning: could not pre-decode image '${key}' from '${url}'.`, err.path, `resolving with fallback`);\n                    resolve({\n                        type: 'image',\n                        key: key,\n                        value: optional && url === '' ?\n                        createBase64Image(blankImage) :\n                        createBase64Image(defaultImage)\n                    });\n                });\n            } else {\n                resolve({\n                    type: 'image',\n                    key: key,\n                    value: image\n                });\n            }\n        };\n\n        // load error\n        image.onerror = (err) => {\n            if (!optional) {\n                console.warn(`Warning: could not load image '${key}' from '${url}'.`, err.path, `resolving with fallback`);\n            }\n\n            resolve({\n                type: 'image',\n                key: key,\n                value: optional && url === '' ?\n                createBase64Image(blankImage) :\n                createBase64Image(defaultImage)\n            });\n        };\n    });\n\n}\n\nconst loadSound = (key, url) => {\n    let result = { type: 'sound', key: key, value: null };\n\n    return new Promise((resolve, reject) => {\n        // reject with error for missing key or url\n        if (!key) { reject(new Error('key required')) }\n\n        audioBufferLoader(url)\n            .then((sound) => {\n                resolve({\n                    type: 'sound',\n                    key: key,\n                    value: sound\n                });\n            })\n            .catch((err) => {\n                // log an warning and resolve a silent audio buffer\n                // previously created with new AudioBuffer (unsupported on safari)\n                // note: sampleRate must also be 22050 to work on safari\n                // value: new AudioBuffer({ length: 1, numberOfChannels: 1, sampleRate: 8000 })\n                console.warn(`Warning: could not load sound '${key}' from '${url}'.`, err, `resolving with fallback`);\n\n                const audioCtx = audioContext()\n                resolve({\n                    type: 'sound',\n                    key: key,\n                    value: audioCtx.createBuffer(1, 1, 22050)\n                })\n                \n            })\n    });\n}\n\nconst loadFont = (key, fontName, opts = {}) => {\n    return new Promise((resolve, reject) => {\n        let { fallback } = opts;\n\n        // reject with error for missing key or url\n        if (!key) { reject(new Error('key required')) }\n\n        if (!fontName) { resolve({\n            type: 'font',\n            key: key,\n            value: fallback || 'Arial'\n        })}\n\n        WebFont.load({\n            google: {\n                families: [fontName]\n            },\n            fontactive: familyName => {\n                resolve({\n                    type: 'font',\n                    key: key,\n                    value: familyName\n                });\n            },\n            fontinactive: () => {\n                resolve({\n                    type: 'font',\n                    key: key,\n                    value: fallback || 'Arial'\n                });\n            }\n        });\n    });\n}\n\nexport { loadList, loadImage, loadSound, loadFont };\n","// get random number between min and max\nconst randomBetween = (min, max, type) => {\n    const rand = Math.random() * (max - min) + min;\n\n    if (type && type === 'int') {\n        return Math.round(rand);\n    }\n\n    return rand;\n}\n\n// apply a lower and upper bound to a number\nconst bounded = (n, min, max) => {\n    return [n]\n    .map(n => n < min ? min : n)\n    .map(n => n > max ? max : n)\n    .reduce(n => n);\n}\n\n// check if n is within bounds\nconst isBounded = (n, min, max) => {\n    return n > min && n < max;\n}\n\n// color converter\nconst hexToRgbA = (hex, opacity) => {\n    let h=hex.replace('#', '');\n    h =  h.match(new RegExp('(.{'+h.length/3+'})', 'g'));\n\n    for(let i=0; i<h.length; i++)\n        h[i] = parseInt(h[i].length==1? h[i]+h[i]:h[i], 16);\n\n    if (typeof opacity != 'undefined')  h.push(opacity);\n\n    return 'rgba('+h.join(',')+')';\n}\n\n// create throttled function\n// checkout: https://outline.com/nBajAS\nconst throttled = (delay, fn) => {\n    let lastCall = 0;\n    return function (...args) {\n        const now = (new Date).getTime();\n        if (now - lastCall < delay) {\n            return;\n        }\n        lastCall = now;\n        return fn(...args);\n    }\n}\n\n// find an entity in the list\n// useful for checking for collisions\nconst findInList = (entList, fn) => {\n    return entList\n        .find((ent) => {\n            return fn(ent);\n        }) ?\n        true : false;\n}\n\n// find an entity in an object\n// useful for checking for collisions\nconst findInObject = (entObject, fn) => {\n    return Object.entries(entObject)\n        .find((ent) => {\n            return fn(ent);\n        }) ?\n        true : false;\n}\n\n// find an entity in an object or list\n// wrapper for findInList and findInObject\nconst findIn = (entities, fn) => {\n\n    // check against list\n    if (Array.isArray(entities)) {\n        return findInList(entities, fn);\n    }\n\n    // check against object\n    if (Object.keys(entities) > 1) {\n        return findInObject(entities, fn);\n    }\n\n    return false;\n};\n\n// toy hash for prefixes\n// useful for prefexing localstorage keys\nconst hashCode = (str, base = 16) => {\n    return [str.split(\"\")\n    .reduce(function(a, b) {\n      a = ((a << 5) - a) + b.charCodeAt(0);\n      return a & a\n    }, 0)] // create simple hash from string\n    .map(num => Math.abs(num)) // only positive numbers\n    .map(num => num.toString(base)) // convert to base\n    .reduce(h => h); // fold\n};\n\n// resize image by width\nconst resizeByWidth = (width, naturalWidth, naturalHeight) => {\n    // cross multiply to get new height\n    return {\n        width: parseInt(width),\n        height: parseInt(width * naturalHeight / naturalWidth)\n    };\n};\n\n// resize image by height\nconst resizeByHeight = (height, naturalWidth, naturalHeight) => {\n    // cross multiply to get new width\n    return {\n        height: parseInt(height),\n        width: parseInt(height * naturalWidth / naturalHeight)\n    };\n};\n\n// resize wrapper\nconst resize = ({ image, width, height }) => {\n    // image required\n    if (!image) {\n        console.error('resize requires an image');\n        return;\n    }\n\n    // width or height required\n    if (!width && !height) {\n        console.error('resize requires a width or height');\n        return;\n    }\n\n    // useless echo\n    if (width && height) {\n        return { width: width, height: height };\n    }\n\n    // set variables\n    let naturalWidth = image.width;\n    let naturalHeight = image.height;\n    let result = {};\n\n    // if width: resize by width\n    if (width) {\n        result = {\n            ...result,\n            ...resizeByWidth(width, naturalWidth, naturalHeight)\n        }\n    }\n\n    // if height: resize by height\n    if (height) {\n        result = {\n            ...result,\n            ...resizeByHeight(height, naturalWidth, naturalHeight)\n        }\n    }\n\n    return result;\n};\n\nexport {\n    resize,\n    bounded,\n    isBounded,\n    findIn,\n    hexToRgbA,\n    randomBetween,\n    hashCode,\n    throttled\n};","/**\n * game/utils/baseUtils.js\n * \n * What it Does:\n *   This file contains utilities for the game\n * \n *   randomBetween: get a numbers a min and a max, optionally ask for an int\n * \n *   getDistance: get the distance between to points with an x and y\n * \n *   bounded: apply a lower and upper bound to a number\n *   useful for add limits to AI character movements\n * \n *   isBounded: check if number is within a min and max\n * \n *   getCursorPosition: get cursor position on the canvas\n *   needed for when tob bar is active\n * \n *   hexToRgbA: color converter for easier use of the alpha channel\n * \n *   throttled: wraps a function so that it can't be called until the delay\n *   in milliseconds has gone by. useful for stopping unwanted side effects of button mashing.\n *   https://gph.is/1syA0yc\n * \n * \n * What to Change:\n *   Add any new methods that don't fit anywhere else\n *   eg. \n * \n */\n\n// get random number between min and max\nconst randomBetween = (min, max, type) => {\n    const rand = Math.random() * (max - min) + min;\n\n    if (type && type === 'int') {\n        return Math.round(rand);\n    }\n\n    return rand;\n}\n\n// distance between two points\nconst getDistance = (pointA, pointB) => {\n    let vx = pointA.x - pointB.x;\n    let vy = pointA.y - pointB.y;\n\n    return Math.sqrt(vx * vx + vy * vy);\n}\n\n// pick random element from a list\nconst pickFromList = (list) => {\n    if (!Array.isArray(list) || list.length < 1) { return; }\n\n    let index = randomBetween(0, list.length - 1, 'int');\n    return list[index];\n}\n\n// getMaxFromList\nconst getMaxFromList = (list) => {\n    return list\n    .reduce((max, item) => {\n        return Math.max(max, item);\n    }, 0);\n}\n\n// getMinFromList\nconst getMinFromList = (list) => {\n    return list\n    .reduce((min, item) => {\n        return Math.min(min, item);\n    }, list[0] + 1);\n}\n\n// apply a lower and upper bound to a number\nconst bounded = (n, min, max) => {\n    return [n]\n    .map(n => n < min ? min : n)\n    .map(n => n > max ? max : n)\n    .reduce(n => n);\n}\n\n// check if n is within bounds\nconst isBounded = (n, min, max) => {\n    return n > min && n < max;\n}\n\n// get cursor event position (tap, click, etc)\n// needed for canvas click while top bar active\nconst getCursorPosition = (canvas, event) => {\n    const rect = canvas.getBoundingClientRect();\n    return {\n        x: event.clientX - rect.left,\n        y: event.clientY - rect.top\n    }\n}\n\n// color converter\nconst hexToRgbA = (hex, opacity) => {\n    let h=hex.replace('#', '');\n    h =  h.match(new RegExp('(.{'+h.length/3+'})', 'g'));\n\n    for(let i=0; i<h.length; i++)\n        h[i] = parseInt(h[i].length==1? h[i]+h[i]:h[i], 16);\n\n    if (typeof opacity != 'undefined')  h.push(opacity);\n\n    return 'rgba('+h.join(',')+')';\n}\n\n// create throttled function\n// checkout: https://outline.com/nBajAS\nconst throttled = (delay, fn) => {\n    let lastCall = 0;\n    return function (...args) {\n        const now = (new Date).getTime();\n        if (now - lastCall < delay) {\n            return;\n        }\n        lastCall = now;\n        return fn(...args);\n    }\n}\n\n// toy hash for prefixes\n// useful for prefexing localstorage keys\nconst hashCode = (str, base = 16) => {\n    return [str.split(\"\")\n    .reduce(function(a, b) {\n      a = ((a << 5) - a) + b.charCodeAt(0);\n      return a & a\n    }, 0)] // create simple hash from string\n    .map(num => Math.abs(num)) // only positive numbers\n    .map(num => num.toString(base)) // convert to base\n    .reduce(h => h); // fold\n}\n\nexport {\n    bounded,\n    isBounded,\n    pickFromList,\n    getMaxFromList,\n    getMinFromList,\n    getCursorPosition,\n    getDistance,\n    hexToRgbA,\n    randomBetween,\n    hashCode,\n    throttled\n};","const gridCell = (grid, x, y) => {\n    let cell =  grid &&\n    grid[x] &&\n    grid[x][y];\n\n    return cell || false;\n}\n\nconst gridCol = (grid, x) => {\n    return grid && grid[x];\n}\n\nconst gridRow = (grid, y) => {\n    return grid && grid\n    .filter(x => x && x[y])\n    .map(x => x[y])\n}\n\nconst setGridCell = (grid, cell, value) => {\n    let { x, y } = cell;\n\n    // allocate space on grid\n    if (typeof grid[x] === 'undefined') { grid[x] = []; }\n    if (typeof grid[x][y] === 'undefined') { grid[x][y] = false; }\n\n    // set value\n    grid[x][y] = value;\n\n    return grid;\n}\n\nconst neighborLeft = (grid, cell) => {\n    return gridCell(grid, cell.x - 1, cell.y);\n}\n\nconst neighborRight = (grid, cell) => {\n    return gridCell(grid, cell.x + 1, cell.y);\n}\n\nconst neighborDown = (grid, cell) => {\n    return gridCell(grid, cell.x, cell.y + 1);\n}\n\nconst getCellSize = (width, height, rows, cols) => {\n    let sizeByWidth = Math.round(width / cols);\n    let sizeByHeight = Math.round(height / rows);\n\n    return Math.min(sizeByWidth, sizeByHeight);\n}\n\nexport {\n    gridCell,\n    gridCol,\n    gridRow,\n    setGridCell,\n    neighborLeft,\n    neighborRight,\n    neighborDown,\n    getCellSize\n};","/**\r\n * @module  is-audio-buffer\r\n */\r\n'use strict';\r\n\r\nmodule.exports = function isAudioBuffer (buffer) {\r\n\t//the guess is duck-typing\r\n\treturn buffer != null\r\n\t&& typeof buffer.length === 'number'\r\n\t&& typeof buffer.sampleRate === 'number' //swims like AudioBuffer\r\n\t&& typeof buffer.getChannelData === 'function' //quacks like AudioBuffer\r\n\t// && buffer.copyToChannel\r\n\t// && buffer.copyFromChannel\r\n\t&& typeof buffer.duration === 'number'\r\n};\r\n","/** @module  audio-play Play buffer in browser via WAA */\r\n\r\n'use strict'\r\n\r\nvar getContext = require('audio-context')\r\nvar isAudioBuffer = require('is-audio-buffer')\r\n\r\nmodule.exports = function Play (buffer, how, cb) {\r\n\tif (!isAudioBuffer(buffer)) throw Error('Argument should be an audio buffer')\r\n\r\n\tif (how instanceof Function) {\r\n\t\tcb = how\r\n\t}\r\n\r\n\thow = how || {}\r\n\tcb = cb || function () {}\r\n\r\n\tif (how.context == null) how.context = getContext()\r\n\r\n\tif (how.currentTime == null) how.currentTime = 0\r\n\tif (how.start == null) how.start = 0\r\n\tif (how.end == null) how.end = buffer.duration\r\n\thow.start = normTime(how.start, buffer.duration)\r\n\thow.end = normTime(how.end, buffer.duration)\r\n\r\n\tvar sourceNode = createNode(buffer, how)\r\n\r\n\tif (!how.gain) {\r\n\t\thow.gain = how.context.createGain()\r\n\t\thow.gain.gain.value = how.volume == null ? 1 : how.volume\r\n\t\thow.gain.connect(how.context.destination)\r\n\t}\r\n\tsourceNode.connect(how.gain)\r\n\r\n\tsourceNode.addEventListener('ended', cb)\r\n\r\n\t//provide API\r\n\tplay.play = pause.play = play\r\n\tplay.pause = pause.pause = pause\r\n\r\n\tvar startTime = 0\r\n\tvar isPlaying = false\r\n\r\n\treturn how.autoplay != false ? play() : play\r\n\r\n\tfunction play () {\r\n\t\tif (isPlaying) return pause\r\n\r\n\t\tisPlaying = true\r\n\r\n\t\tstartTime = how.context.currentTime\r\n\r\n\t\tif (how.loop) {\r\n\t\t\tsourceNode.start(startTime, how.start + how.currentTime)\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsourceNode.start(startTime, how.start + how.currentTime, how.end - how.start)\r\n\t\t}\r\n\r\n\t\treturn pause\r\n\t}\r\n\r\n\tfunction pause () {\r\n\t\tif (!isPlaying) return pause.play\r\n\t\tisPlaying = false\r\n\r\n\t\tsourceNode.stop()\r\n\t\tsourceNode.removeEventListener('ended', cb)\r\n\r\n\t\tvar playedTime = (how.context.currentTime - startTime)\r\n\r\n\t\thow.autoplay = false\r\n\t\thow.currentTime = playedTime\r\n\r\n\t\tvar playback = Play(buffer, how, cb)\r\n\t\tplay.play = pause.play = playback.play\r\n\t\tplay.pause = pause.pause = playback.pause\r\n\t\tplay.currentTime = pause.currentTime = playback.currentTime = how.currentTime\r\n\r\n\t\treturn playback\r\n\t}\r\n}\r\n\r\nfunction normTime (time, duration) {\r\n\treturn time < 0 ? (duration + (time % duration)) : Math.min(duration, time)\r\n}\r\n\r\nfunction createNode (buffer, how) {\r\n\tvar sourceNode = how.context.createBufferSource()\r\n\r\n\tsourceNode.buffer = buffer\r\n\r\n\t//init options\r\n\tif (how.detune != null) sourceNode.detune = how.detune\r\n\tif (how.rate != null) sourceNode.playbackRate.value = how.rate\r\n\r\n\r\n\tif (how.loop) {\r\n\t\tsourceNode.loop = true\r\n\t\tsourceNode.loopStart = how.start\r\n\t\tsourceNode.loopEnd = how.end\r\n\t}\r\n\r\n\treturn sourceNode\r\n}\r\n","import {\n    randomBetween,\n    getDistance,\n    isBounded\n} from './baseUtils.js';\n\n// check if hit is in box\nconst inBox = (x, y, box) => {\n    // check x and y against box\n    const inX = isBounded(x, box.left, box.right);\n    const inY = isBounded(y, box.top, box.bottom);\n\n    return inX && inY;\n}\n\n// return larger bounds\n// useful for hiding images offscreen\nconst padBounds = (bounds, x, y) => {\n    return {\n        top: bounds.top - y,\n        right: bounds.right + x,\n        bottom: bounds.bottom + y,\n        left: bounds.bottom - x\n    };\n}\n\n// get random point or screen\nconst pickLocation = (bounds) => {\n    return {\n        x: randomBetween(bounds.left, bounds.right),\n        y: randomBetween(bounds.top, bounds.bottom)\n    };\n}\n\n// pick new location for moles so they aren't crowded\n// pick random location in bounds and distance from point\nconst pickLocationAwayFrom = (bounds, point, distance, depth = 0, maxDepth = 10) => {\n    // limit depth\n    if (depth > maxDepth) { return; }\n\n    // get random point or screen\n    const location = pickLocation(bounds);\n    const locationDistance = getDistance(location, point); \n\n    // return location when location is distance \n    // away from point, else try a new location\n    return locationDistance >= distance ?\n    location :\n    pickLocationAwayFrom(bounds, point, distance, depth + 1);\n}\n\nconst pickLocationAwayFromList = (bounds, list, distance, depth = 0, maxDepth = 10) => {\n    // limit depth\n    if (depth > maxDepth) { return; }\n\n    // return any location if list is empty\n    if (list.length < 1) {\n        return pickLocation(bounds);\n    }\n\n    // get location checked against first element\n    const location = pickLocationAwayFrom(bounds, list[0], distance);\n\n    // check if point has close neighbors in list\n    const hasCloseNeighbor = list.find(point => {\n        // return if less than distance\n        let dist = getDistance(location, point);\n        return dist < distance;\n    });\n\n    // return location without close neighbors\n    // else try new location\n    return hasCloseNeighbor ?\n    pickLocationAwayFromList(bounds, list, distance, depth + 1) :\n    location;\n}\n\nexport {\n    padBounds,\n    pickLocation,\n    pickLocationAwayFrom,\n    pickLocationAwayFromList,\n    inBox\n};","import { bounded } from './baseUtils.js'\n\nclass Sprite {\n    constructor({ x, y, width, height, speed, direction, bounds }) {\n        // x and y\n        this.x = x;\n        this.y = y;\n\n        // previous x and y\n        this.px = x;\n        this.py = y;\n\n        // center x and y\n        this.cx = x + (width/2);\n        this.cy = y + (height/2);\n\n        // velocity x and y\n        this.vx = 0;\n        this.vy = 0;\n\n        // width and height\n        this.width = width;\n        this.height = height;\n\n        // radius\n        this.radius = (width + height) / 4;\n\n        // speed of sprite\n        this.speed = speed || 1;\n\n        // direction\n        this.direction = direction || 'right';\n\n        // bounds\n        this.setBounds(bounds);\n    }\n\n    move(x, y, m) {\n        let dx = x === 0 ? this.x : this.x + (x * this.speed * m);\n        let dy = y === 0 ? this.y : this.y + (y * this.speed * m);\n        \n        this.setX(dx);\n        this.setY(dy);\n\n        // set direction\n        if (x < 0) { this.direction = 'right'; }\n        if (x > 0) { this.direction = 'left'; }\n    }\n\n    setX(nx) {\n        // apply x bounds\n        const x = bounded(nx, this.bounds.left, this.bounds.right - this.width);\n\n        this.px = this.x; // store previous x value\n        this.x = x; // set x\n\n        this.cx = this.x + (this.width/2); // set center x\n        this.vx = this.x - this.px; // set velocity x\n    }\n\n    setY(ny) {\n        // apply x bounds\n        const y = bounded(ny, this.bounds.top, this.bounds.bottom - this.height);\n\n        this.py = this.y; // store previous y value\n        this.y = y; // set y\n\n        this.cy = this.y + (this.height/2); // set center y\n        this.vy = this.y - this.py; // set velocity y\n    }\n\n    setBounds(bounds) {\n        this.bounds = {\n            ...this.bounds,\n            ...bounds\n        }\n    }\n}\n\nexport default Sprite;","/**\n * game/objects/imageSprite.js\n * \n * What it Does:\n *   This file is a basic image sprite it extends the sprite class\n *   and draws an image to the screen\n * \n * What to Change:\n *   Add any new methods you want all your\n *   game characters that are also sprites to have.\n *   eg. \n * \n */\n\nimport Sprite from './sprite.js';\n\nclass ImageSprite extends Sprite {\n    constructor(options) {\n        super(options);\n\n        this.ctx = options.ctx;\n        this.image = options.image;\n    }\n\n    draw() {\n        // save canvas context\n        this.ctx.save();\n\n        // code for flipping image to match direction\n        let scaleX = this.direction === 'left' ? -1 : 1;\n        let xPosition = this.direction === 'left' ? -1 * this.x : this.x;\n        let trX = this.direction === 'left' ? this.width : 0;\n\n        this.ctx.translate(trX, 0);\n        this.ctx.scale(scaleX, 1);\n\n        // draw the image to canvas\n        this.ctx.drawImage(this.image, xPosition, this.y, this.width, this.height);\n\n        // restore canvas context\n        this.ctx.restore();\n    }\n}\n\nexport default ImageSprite;","import ImageSprite from './imageSprite.js';\n\nclass Block extends ImageSprite {\n    constructor(options) {\n        super({\n            ...options,\n            ...{\n                width: options.size,\n                height: options.size\n            }\n        });\n\n        this.color = options.color;\n\n\n        this.cell = options.cell;\n        this.size = options.size;\n\n        this.x = this.cell.x * this.size;\n        this.y = this.cell.y * this.size;\n    }\n\n    draw() {\n        // draw background color\n        this.ctx.fillStyle = this.color;\n        this.ctx.fillRect(this.x, this.y, this.width, this.height);\n\n        // draw image\n        super.draw();\n    }\n\n    shift({ x = 0, y = 0 }) {\n        // update cell\n        this.cell = {\n            x: this.cell.x + x,\n            y: this.cell.y + y\n        };\n\n        // update x and y\n        this.x = this.cell.x * this.size;\n        this.y = this.cell.y * this.size;\n   }\n\n}\n\nexport default Block;","import {\n    getMaxFromList,\n    getMinFromList,\n} from './baseUtils.js';\n\nimport {\n    padBounds\n} from './spriteUtils.js';\n\nimport Block from './block.js';\n\nclass Piece {\n    constructor({ ctx, board, image, color, shape, cellSize, cellBounds, bounds }) {\n        this.ctx = ctx;\n        this.board = board;\n\n        this.image = image;\n        this.color = color;\n\n        this.cellBounds = cellBounds;\n        this.bounds = bounds;\n\n        this.cellSize = cellSize;\n\n        this.preplaceTick = 0;\n        this.placed = false;\n\n        this.body = this.createBody(shape);\n        this.box = { top: 0, right: 0, bottom: 0, left: 0 };\n\n        // shift to center\n        let center = Math.round((board.columns / 2) - (this.body.length / 2));\n        this.shift({ x: center, y: 0 });\n    }\n\n    draw() {\n        this.body\n        .forEach(block => block.draw());\n    }\n\n    getBox(body) {\n        return [body]\n        .map(body => {\n            return {\n                listY: body.map(block => block.cell.y),\n                listX: body.map(block => block.cell.x)\n            }\n        })\n        .map(cell => {\n            return {\n                top: getMinFromList(cell.listY),\n                bottom: getMaxFromList(cell.listY),\n                right: getMaxFromList(cell.listX),\n                left: getMinFromList(cell.listX)\n            }\n        })\n        .reduce(box => box);\n    }\n\n    shift({ x = 0, y = 0 }) {\n        // don't shift off the board\n        let hitLeft = this.box.left + x < 0;\n        let hitRight = this.box.right + x > this.board.width - 1;\n\n        if (this.placed || hitLeft || hitRight) {\n            return;\n        }\n\n        // update body\n        this.body.forEach(block => block.shift({ x: x, y: y }));\n\n        // update box\n        this.box = this.getBox(this.body);\n    }\n\n    rotate() {\n        // pick a rotation point\n        let origin = this.body[0];\n\n        // rotate block around origin\n        this.body.forEach(block => {\n            block.cell = this.rotateCellAround(block.cell, origin.cell);\n        })\n\n        // shift in place to update x and y\n        this.shift({ x: 0, y: 0 });\n    }\n\n    rotatedCells() {\n        let origin = this.body[0];\n        return this.body\n        .map(block => block.cell)\n        .map(cell => {\n            return this.rotateCellAround(cell, origin.cell);\n        })\n    }\n\n    rotateCellAround(cell, origin) {\n        return [cell]\n        .map((cell) => {\n            // translate origin to 0,0\n            return {\n                x: cell.x - origin.x,\n                y: cell.y - origin.y\n            };\n        })\n        .map((cell, idx, arr) => {\n            // rotate around origin\n            let prev = arr[idx - 1] || arr[arr.length - 1];\n            return {\n                x: -prev.y,\n                y: prev.x\n            }\n        })\n        .map((cell) => {\n            // translate back to starting x,y\n            return {\n                x: cell.x + origin.x,\n                y: cell.y + origin.y,\n            }\n        })\n        .reduce(cell => cell);\n    }\n\n    selectShape(idx) {\n        // Tetriminos\n\n        // Straight Bar\n        const bar = [\n            { x: 1, y: 0 },\n            { x: 0, y: 0 },\n            { x: 2, y: 0 },\n            { x: 3, y: 0 }\n        ];\n\n        // Left L\n        const leftL = [\n            { x: 1, y: 1 },\n            { x: 0, y: 1 },\n            { x: 0, y: 0 },\n            { x: 2, y: 1 }\n        ];\n\n        // Right L\n        const rightL = [\n            { x: 2, y: 1 },\n            { x: 1, y: 1 },\n            { x: 3, y: 1 },\n            { x: 3, y: 0 }\n        ];\n\n        // Box\n        const box = [\n            { x: 0, y: 0 },\n            { x: 0, y: 1 },\n            { x: 1, y: 0 },\n            { x: 1, y: 1 }\n        ];\n\n        // Left S\n        const leftS = [\n            { x: 1, y: 1 },\n            { x: 1, y: 0 },\n            { x: 0, y: 1 },\n            { x: 2, y: 0 }\n        ];\n\n        // Right S\n        const rightS = [\n            { x: 1, y: 1 },\n            { x: 1, y: 0 },\n            { x: 0, y: 0 },\n            { x: 2, y: 1 }\n        ];\n\n        // Tee\n        const tee = [\n            { x: 1, y: 1 },\n            { x: 1, y: 0 },\n            { x: 0, y: 1 },\n            { x: 2, y: 1 }\n        ];\n\n       return [\n            bar,\n            leftL,\n            rightL,\n            box,\n            leftS,\n            rightS,\n            tee\n       ][idx];\n    }\n\n    createBody(idx) {\n        return this.selectShape(idx)\n        .map(cell => {\n            return new Block({\n                ctx: this.ctx,\n                color: this.color,\n                image: this.image,\n                cell: cell,\n                size: this.cellSize,\n                bounds: padBounds(this.bounds, 0, this.cellSize * 2)\n            })\n        })\n    }\n\n}\n\nexport default Piece;","const requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame ||\n      window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;\nconst cancelAnimationFrame = window.cancelAnimationFrame || window.mozCancelAnimationFrame;\n\nimport {\n    loadList,\n    loadImage,\n    loadSound,\n    loadFont\n} from 'game-asset-loader';\n\nimport {\n    hashCode\n} from './utils.js'\n\nimport {\n    pickFromList\n} from './baseUtils.js'\n\nimport {\n    gridRow,\n    neighborDown,\n    neighborLeft,\n    neighborRight,\n    setGridCell,\n    getCellSize\n} from './grid.js';\n\nimport audioContext from 'audio-context';\nimport audioPlayback from 'audio-play';\n\nimport Piece from './piece.js';\nimport ImageSprite from './imageSprite.js';\n\nclass Game {\n\n    constructor(root, config) {\n        this.root = root;\n        this.config = config; // config\n        this.prefix = hashCode(this.config.settings.name); // set prefix for local-storage keys\n\n        console.log(this.config)\n\n        // create game screen\n        this.canvas = document.createElement('canvas');\n        this.root.appendChild(this.canvas);\n\n        this.ctx = this.canvas.getContext(\"2d\"); // game screen context\n\n        this.audioCtx = audioContext();\n        this.playlist = [];\n\n        // setup event listeners\n        // handle keyboard events\n        document.addEventListener('keydown', ({ code }) => this.handleKeyboardInput('keydown', code));\n        document.addEventListener('keyup', ({ code }) => this.handleKeyboardInput('keyup', code));\n\n\n        // setup event listeners for mouse movement\n        document.addEventListener('touchmove', ({ touches }) => this.handleTouchMove(touches[0]));\n\n\n        // handle swipes\n        document.addEventListener('touchstart', ({ touches }) => this.handleSwipe('touchstart', touches[0]));\n        document.addEventListener('touchmove', ({ touches }) => this.handleSwipe('touchmove', touches[0]));\n        document.addEventListener('touchend', ({ touches }) => this.handleSwipe('touchend', touches[0]));\n\n    }\n\n    init() {\n        // frame count, rate, and time\n        // this is just a place to keep track of frame rate (not set it)\n        this.frame = {\n            count: 0,\n            time: Date.now(),\n            rate: null,\n            scale: null\n        };\n\n        // set canvas\n        this.canvas.height = this.root.clientHeight; // set game screen height\n        this.canvas.width = this.root.clientWidth; // set game screen width\n\n        // set screen\n        this.screen = {\n            top: 0,\n            bottom: this.canvas.height,\n            left: 0,\n            right: this.canvas.width,\n            centerX: this.canvas.width / 2,\n            centerY: this.canvas.height / 2,\n            width: this.canvas.width,\n            height: this.canvas.height,\n            scale: ((this.canvas.width + this.canvas.height) / 2) * 0.003\n        };\n\n\n        // game settings\n        this.state = {\n            current: 'loading',\n            prev: '',\n            tickRate: parseInt(this.config.settings.tickRate),\n            score: 0,\n            paused: false,\n            muted: localStorage.getItem(this.prefix.concat('muted')) === 'true'\n        };\n\n\n        this.input = {\n            active: 'keyboard',\n            keyboard: { up: false, right: false, left: false, down: false },\n            mouse: { x: 0, y: 0, click: false },\n            swipe: { },\n            touch: { x: 0, y: 0 },\n        };\n\n        let columns = parseInt(this.config.settings.columns);\n        let rows = parseInt(this.config.settings.rows);\n\n        this.board = {\n            grid: [],\n            blocks: [],\n            columns: columns,\n            rows: rows,\n            height: rows,\n            width: columns,\n            cellSize: getCellSize(this.screen.width, this.screen.height, rows, columns),\n            lastClear: 0\n        }\n\n        // tick queue and random bag\n        this.tickQueue = [];\n        this.bag = [];\n\n        // create lists\n        this.pieces = []; // place to put active pieces\n        this.stack = []; // place to put stacked blocks\n        this.cleared = []; // place to host cleared blocks\n\n        this.images = {}; // place to keep images\n        this.sounds = {}; // place to keep sounds\n        this.fonts = {}; // place to keep fonts\n\n\n        // set document body to backgroundColor\n        this.root.style.backgroundColor = this.config.colors.backgroundColor;\n    }\n\n    load() {\n        // load pictures, sounds, and fonts\n    \n        if (this.sounds && this.sounds.backgroundMusic) { this.sounds.backgroundMusic.pause(); } // stop background music when re-loading\n\n        this.init(); // apply new configs\n        \n        // load game assets\n        const gameAssets = [\n            loadImage('block1', this.config.images.block1),\n            loadImage('block2', this.config.images.block2),\n            loadImage('block3', this.config.images.block3),\n            loadImage('block4', this.config.images.block4),\n            loadImage('block5', this.config.images.block5),\n            loadImage('block6', this.config.images.block6),\n            loadImage('spectatorLeft', this.config.images.spectatorLeft),\n            loadImage('spectatorRight', this.config.images.spectatorRight),\n            loadSound('clearSound', this.config.sounds.clearSound),\n            loadSound('dropSound', this.config.sounds.dropSound),\n            loadSound('backgroundMusic', this.config.sounds.backgroundMusic),\n            loadFont('gameFont', this.config.settings.fontFamily)\n        ];\n\n        // put the loaded assets the respective containers\n        loadList(gameAssets, (progress) => {\n            console.log(`loading: ${progress.percent}%`);\n        })\n        .then((assets) => {\n\n            this.images = assets.image;\n            this.sounds = assets.sound;\n\n        })\n        .then(() => this.create())\n        .catch(err => console.error(err));\n    }\n\n    create() {\n\n        // setup block styles\n        this.blockStyles = [\n            {\n                color: this.config.colors.block1,\n                image: this.images.block1\n            },\n            {\n                color: this.config.colors.block2,\n                image: this.images.block2\n            },\n            {\n                color: this.config.colors.block3,\n                image: this.images.block3\n            },\n            {\n                color: this.config.colors.block4,\n                image: this.images.block4\n            },\n            {\n                color: this.config.colors.block5,\n                image: this.images.block5\n            },\n            {\n                color: this.config.colors.block6,\n                image: this.images.block6\n            }\n        ];\n\n        this.setState({ current: 'ready' });\n        this.play();\n    }\n\n    play() {\n        // update game characters\n\n        // clear the screen of the last picture\n        this.ctx.fillStyle = this.config.colors.backgroundColor; \n        this.ctx.fillRect(0, 0, this.canvas.width, this.canvas.height);\n\n        this.ctx.fillStyle = this.config.colors.boardColor; \n        this.ctx.fillRect(0, 0, this.board.width * this.board.cellSize, this.board.height * this.board.cellSize);\n\n        // draw and do stuff that you need to do\n        // no matter the game state\n        // this.ctx.drawImage(this.images.backgroundImage, 0, 0, this.canvas.width, this.canvas.height);\n\n        // ready to play\n        if (this.state.current === 'ready') {\n\n          if (this.state.prev === 'loading') {\n\n            this.setState({ current: 'ready' });\n          }\n\n        }\n\n        // game play\n        if (this.state.current === 'play') {\n             // if last state was 'ready'\n\n            if (this.state.prev === 'ready') {\n            }\n\n            // background music\n            if (!this.state.muted && !this.state.backgroundMusic) {\n                this.state.backgroundMusic = true;\n                this.playback('backgroundMusic', this.sounds.backgroundMusic, {\n                    start: 0,\n                    end: this.sounds.backgroundMusic.duration,\n                    loop: true,\n                    context: this.audioCtx\n                });\n            }\n\n            // check for game over\n            // game over if there are blocks on the top row\n            let topRow = gridRow(this.board.grid, 0);\n            if (topRow.length > 0) {\n                this.setState({ current: 'over' });\n            }\n\n            // get new random bag of pieces\n            // if bag is empty\n            if (this.bag.length < 1) {\n                this.bag = [0, 1, 2, 3, 4, 5, 6];\n            }\n\n            // every game tick update the game\n            let queuedTick = this.tickQueue.length > 0;\n            if (queuedTick) {\n\n                // run tick task: shift, rotate, etc\n                this.tickQueue.sort((a, b) => a.priority - b.priority);\n                const tick = this.tickQueue.pop();\n                tick.run();\n\n                // if there is a placed piece\n                // transfer all the blocks from a placed piece\n                // to the stack of blocks\n                this.stack = [\n                    ...this.stack,\n                    ...this.placedBlocks()\n                ];\n\n                // remove placed pieces from pieces list\n                this.pieces = [\n                    ...this.pieces\n                    .filter(piece => !piece.placed)\n                ]\n\n                // if there is no piece in play\n                // put a new piece in play\n                if (this.pieces.filter(p => !p.placed).length < 1) {\n                    // pick a random style\n                    // and pick a random shape from the bag\n                    let block = pickFromList(this.blockStyles);\n                    let shape = pickFromList(this.bag);\n\n                    this.pieces = [\n                        ...this.pieces,\n                        new Piece({\n                            ctx: this.ctx,\n                            board: this.board,\n                            image: block.image,\n                            color: block.color,\n                            shape: shape,\n                            cellSize: this.board.cellSize,\n                            cellBounds: {\n                                top: 0,\n                                right: this.board.width,\n                                bottom: this.board.height,\n                                left: 0\n                            },\n                            bounds: this.screen\n                        })\n                    ]\n\n                    // remove shape from the bag\n                    this.bag = [\n                        ...this.bag\n                        .filter(s => s != shape)\n                    ]\n                }\n\n\n                // update board blocks\n                this.board.blocks = [\n                    ...this.pieces\n                    .map(piece => piece.body)\n                    .reduce((blocks, body) => {\n                        // for Safari 11 support\n                        // used in place of Array.flat()\n\n                        return [...blocks, ...body];\n                    }, []),\n                    ...this.stack\n                ]\n\n                // update the grid with\n                // current placed block locations\n                this.board.grid = this.stack\n                .map(blocks => blocks.cell)\n                .reduce((grid, cell) => {\n\n                   // flag the grid cell as occupied by a block\n                   return setGridCell(grid, cell, true);\n\n                }, [])\n\n            }\n\n            // schedule a tick to shift piece down by tick rate\n            let scheduledTick = this.frame.count % this.state.tickRate === 0;\n            if (scheduledTick) {\n                \n                // queue shift down for block in the piece\n                this.queueTick(1, () => this.shiftPieceDown());\n\n                // clear-line\n                // full rows of block get removed\n                // get row counts (how many placed blocks are in each row)\n                let rowCounts = this.stack\n                .map(block => block.cell.y)\n                .reduce((rows, y) => {\n\n                    // set empty cell to 0\n                    if (typeof rows[y] === 'undefined') { rows[y] = 0; }\n\n                    // increment cell full count\n                    rows[y] += 1;\n\n                    return rows;\n                }, {})\n\n                // get full rows (row count equals board columns)\n                let fullRows = Object.entries(rowCounts)\n                .filter(ent => ent[1] === this.board.columns)\n                .map(ent => parseInt(ent[0]));\n\n                // remove blocks from full row\n                // and shift the stack down\n                if (fullRows.length > 0) {\n                    // set cleared stamp\n                    this.board.lastClear = Date.now();\n\n                    // award points\n                    this.setState({ score: this.state.score + 100 });\n\n                    // images from cleared line to cleared\n                    // as image sprites\n                    this.cleared = [\n                        ...this.cleared,\n                        ...this.stack\n                        .filter(block => block.cell.y === fullRows[0])\n                        .map(block => {\n                            return new ImageSprite({\n                                ctx: this.ctx,\n                                image: block.image,\n                                x: block.x,\n                                y: block.y,\n                                width: block.width,\n                                height: block.height,\n                                speed: 5,\n                                bounds: null\n                            })\n                        })\n                    ];\n\n                    // clear-line gravity\n                    // do cascade style clear-line gravity\n                    // https://tetris.fandom.com/wiki/Line_clear#Line_clear_gravity\n\n                    // mark all block above line as unsupported\n                    // remove blocks\n                    this.stack = [\n                        ...this.stack\n                        .map(block => {\n                            if (block.cell.y < fullRows[0]) {\n                                block.unsupported = true;\n                            }\n\n                            return block;\n                        })\n                        .filter(block => {\n                            // remove full row blocks\n                            return block.cell.y != fullRows[0];\n                        })\n                    ]\n\n                    this.playback('clearSound', this.sounds.clearSound);\n\n                    // queue shift down for blocks in the stack\n                    this.queueTick(1, () => this.shiftStackDown());\n                }\n\n\n            }\n\n            // draw board\n            this.board.blocks\n            .forEach(block => block.draw());\n\n            // update cleared\n            this.cleared = [\n                ...this.cleared\n                .map((sprite, idx) => {\n                    let dx = idx % 2 === 0 ? 0.5 : -0.5;\n                    let dy = idx % 3 === 0 ? -1 : -1.5;\n\n                    sprite.move(dx, dy, this.frame.scale);\n\n                    return sprite;\n                })\n                .filter(sprite => sprite.y > 0)\n                .filter(sprite => sprite.x > 0 + sprite.width)\n                .filter(sprite => sprite.x < this.screen.right)\n            ]\n\n            // draw cleared\n            this.cleared\n            .forEach(sprite => sprite.draw());\n        }\n\n        // player wins\n        if (this.state.current === 'win') {\n            // win code\n        }\n\n        // game over\n        if (this.state.current === 'over') {\n            // game over code\n        }\n\n        // draw the next screen\n        this.requestFrame(() => this.play());\n    }\n\n\n    shiftStackDown() {\n        // shift un-supported blocks down\n        this.stack = this.stack\n        .map(block => {\n\n            if (block.unsupported) {\n\n                // shift down\n                block.shift({ y: 1 });\n\n                // re-mark as supported\n                block.unsupported = false;\n            }\n\n            return block;\n        })\n    }\n\n    shiftPieceDown() {\n        this.updatePieces((piece) => {\n            // check for bottom\n            let hitBottom = piece.box.bottom > this.board.height - 2;\n\n            // check for blocks below\n            let hasDownNeighbor = piece.body\n                .some(block => {\n                    return neighborDown(this.board.grid, block.cell);\n                })\n\n\n            if (!hitBottom && !hasDownNeighbor) {\n\n                // shift down\n                piece.shift({ y: 1 });\n            } else {\n                piece.placed = true;\n                \n                // if an inifinity mode enabled piece moved or rotated action, reset preplaceTick\n                /*\n                if(this.state.infinityAction) {\n                    piece.preplaceTick = 0;\n                    this.setState({ infinityAction: false });\n                }\n\n                if (piece.preplaceTick >= this.state.lockDelayTicks) {\n\n                    // mark as placed\n                    piece.placed = true;\n                } else {\n                    \n                    // increment preplaceTick\n                    piece.preplaceTick += 1;\n\n                }\n                */\n            }\n\n            return piece;\n        });\n    }\n\n    shiftPieceLeft() {\n        this.updatePieces((piece) => {\n            // check for left blocks\n            let hasLeftNeighbor = piece.body\n            .some(block => {\n                // check there is a block on the left\n                return neighborLeft(this.board.grid, block.cell);\n            });\n\n            if (!hasLeftNeighbor) {\n\n                // shift to the left\n                piece.shift({ x: -1 })\n            }\n\n            return piece;\n        });\n    }\n\n    shiftPieceRight() {\n        this.updatePieces((piece) => {\n            // check for right blocks\n            let hasRightNeighbor = piece.body\n            .some(block => {\n                // check there is a block on the left\n                return neighborRight(this.board.grid, block.cell);\n            });\n\n            if (!hasRightNeighbor) {\n\n                // shift to the right\n                piece.shift({ x: 1 })\n            }\n\n            return piece;\n        });\n    }\n\n    rotatePiece() {\n        this.updatePieces((piece) => {\n            // check if the rotation results would\n            // take up occupied spaces\n            let rotatedCells = piece.rotatedCells()\n            .map(cell => {\n                // add string id\n                cell.id = `${cell.x}-${cell.y}`;\n\n                return cell;\n            })\n\n            // .map(cell => `${cell.x}-${cell.y}`)\n\n            let blockingCells = this.stack\n            .map(block => block.cell)\n            .some(cell => {\n                // check if cells are blocking\n                let id = `${cell.x}-${cell.y}`;\n\n                return rotatedCells\n                .map(cell => cell.id)\n                .includes(`${cell.x}-${cell.y}`);\n            });\n\n            // or be off screen\n            let onEdge = rotatedCells\n            .some(cell => {\n                let { x, y } = cell;\n                let offX = x < 0 || x >= this.board.columns;\n                let offY = y < 0 || y >= this.board.rows;\n\n                return offX || offY;\n            });\n\n            if (!blockingCells && !onEdge) {\n\n                piece.rotate();\n            }\n\n            return piece;\n        });\n    }\n\n    dropPiece() {\n        // drop down until hitting the stack\n        // get the the piece\n        let maxShift = this.board.rows;\n\n        let piece = this.pieces\n        .filter(piece => !piece.placed)\n        .reduce(piece => piece);\n\n        // get the top block of the stack and, calculate the remaining rows\n        let stackCells = this.stack\n        .map(block => block.cell);\n\n        let minShift = piece.body\n        .map(block => block.cell)\n        .reduce((min, cell) => {\n            // find the pairs of cells (piece, stack) on x axis that has the\n            // minimum number of rows in between\n\n            let stackPairs = stackCells.filter(sc => sc.x === cell.x);\n            let minPair = stackPairs.reduce((minP, sp) => {\n                return minP.y < sp.y ? minP : sp;\n            }, { y: maxShift });\n\n            let dy = minPair.y - cell.y;\n\n            return min < dy ? min : dy;\n        }, maxShift);\n\n        // queue downshifts for number of remaining rows\n        for (let row = 0; row < minShift; row += 1) {\n            this.queueTick(0, () => this.shiftPieceDown());\n        }\n\n        this.playback('dropSound', this.sounds.dropSound);\n    }\n\n    updatePieces(fn) {\n        this.pieces = this.pieces\n        .map(p => fn(p));\n    }\n\n    queueTick(priority, fn) {\n\n        // add a new tick to the tick queue\n        this.tickQueue = [\n            { priority: priority, run: fn },\n            ...this.tickQueue\n        ].sort((a, b) => a.priority - b.priority)\n    }\n\n    // event listeners\n    handleClicks(target) {\n        if (this.state.current === 'loading') { return; }\n        // mute\n        if (target.id === 'mute') {\n            this.mute();\n        }\n\n        // pause\n        if (target.id === 'pause') {\n            this.pause();\n        }\n\n        // button\n        if ( target.id === 'button') {\n            this.setState({ current: 'play' });\n        }\n\n        if (this.state.current === 'over') {\n            // restart\n            this.setState({ current: 'loading' });\n            this.reset();\n        }\n\n    }\n\n    handleKeyboardInput(type, code, event) {\n        this.input.active = 'keyboard';\n\n        if (type === 'keydown' && this.state.current === 'play') {\n            // If infinity mode is enabled:\n            // Set flag that a key was pressed\n            if (this.state.modeInfinity) { \n                    this.setState({infinityAction: true})\n            }\n\n            // rotate\n            if (code === 'ArrowUp') {\n                this.queueTick(0, () => this.rotatePiece());\n            }\n\n            // shift left\n            if (code === 'ArrowLeft') {\n                this.queueTick(0, () => this.shiftPieceLeft());\n            }\n\n            // shift right\n            if (code === 'ArrowRight') {\n                this.queueTick(0, () => this.shiftPieceRight());                \n            }\n\n            // shift down\n            if (code === 'ArrowDown') {\n                this.queueTick(0, () => this.shiftPieceDown());\n            }\n\n            // drop\n            if (code === 'Space') {\n                this.dropPiece();\n            }\n        }\n\n        if (type === 'keydown') {\n\n            // any key\n            // reload when game over\n            if (this.state.current.match(/over/)) {\n                this.setState({ current: 'loading' });\n                this.load();\n            }\n\n            // restart when game ready\n            if (this.state.current.match(/ready/)) {\n                this.setState({ current: 'play' });\n                console.log('play!')\n            }\n        }\n    }\n\n    handleTap() {\n        // rotate\n        let now = Date.now();\n        let time = now - this.lastTap;\n\n        if ((time < 300) && (time > 0)) {\n            // If infinity mode is enabled:\n            // Set flag that a key was pressed\n            if (this.state.modeInfinity) { \n                    this.setState({infinityAction: true})\n            }\n            \n            // rotate on double tap   \n            this.queueTick(0, () => this.rotatePiece());\n        }\n\n        this.lastTap = Date.now();\n    }\n\n    // convert swipe to a direction\n    handleSwipeInput(type, touch) {\n        // If infinity mode is enabled:\n        // Set flag that a tap was double pressed\n        if (this.state.modeInfinity) { \n            this.setState({infinityAction: true})\n        }\n\n\n        // clear touch list\n        if (type === 'touchstart') {\n            this.input.touches = [];\n        }\n\n        // add to touch list\n        if (type === 'touchmove') {\n            let { clientX, clientY } = touch;\n            this.input.touches.push({ x: clientX, y: clientY });\n        }\n\n        // get user intention\n        if (type === 'touchend') {\n            let { touches } = this.input;\n            let result = {};\n\n            if (touches.length) {\n\n                // get direction from touches\n                result = this.input.touches\n                .map((touch, idx, arr) => {\n                    // collect diffs\n                    let prev = arr[idx - 1] || arr[0];\n                    return {\n                        x: touch.x,\n                        y: touch.y,\n                        dx: touch.x - prev.x,\n                        dy: touch.y - prev.y\n                    }\n                })\n                .reduce((direction, diff) => {\n                    // sum the diffs\n                    direction.dx += diff.dx;\n                    direction.dy += diff.dy;\n\n                    return direction;\n                });\n\n                // get direction\n                let swipesX = Math.abs(result.dx) > Math.abs(result.dy);\n                let swipesY = Math.abs(result.dy) > Math.abs(result.dx);\n\n                if (swipesX) {\n                    if (result.dx > 0) {\n                        // swipe right: shift right\n                        this.queueTick(0, () => this.shiftPieceRight());\n                    } else {\n                        // swipe left: shift left\n                        this.queueTick(0, () => this.shiftPieceLeft());\n                    }\n                }\n\n                if (swipesY) {\n                    if (result.dy > 0) {\n                        // swipe down: drop\n                        this.dropPiece();\n                    } else {\n                        // swipe up: rotate\n                        // this.queueTick(0, () => this.rotatePiece());\n                    }\n                }\n            }\n        }\n    }\n\n    placedBlocks() {\n        return this.pieces\n        .filter(piece => piece.placed)\n        .map(piece => piece.body)\n        .reduce((blocks, body) => {\n            // for Safari 11 support\n            // used in place of Array.flat()\n\n            return [...blocks, ...body];\n        }, [])\n    }\n\n    // pause game\n    pause() {\n        if (this.state.current != 'play') { return; }\n\n        this.state.paused = !this.state.paused;\n        this.overlay.setPause(this.state.paused);\n\n        if (this.state.paused) {\n            // pause game loop\n            this.cancelFrame(this.frame.count - 1);\n\n            // mute all game sounds\n            this.audioCtx.suspend();\n\n            this.overlay.setBanner('Paused');\n        } else {\n            // resume game loop\n            this.requestFrame(() => this.play(), true);\n\n            // resume game sounds if game not muted\n            if (!this.state.muted) {\n                this.audioCtx.resume();\n            }\n\n            this.overlay.hide('banner');\n        }\n    }\n\n    // mute game\n    mute() {\n        let key = this.prefix.concat('muted');\n        localStorage.setItem(\n            key,\n            localStorage.getItem(key) === 'true' ? 'false' : 'true'\n        );\n        this.state.muted = localStorage.getItem(key) === 'true';\n\n        this.overlay.setMute(this.state.muted);\n\n        if (this.state.muted) {\n            // mute all game sounds\n            this.audioCtx.suspend();\n        } else {\n            // unmute all game sounds\n            if (!this.state.paused) {\n                this.audioCtx.resume();\n            }\n        }\n    }\n\n    playback(key, audioBuffer, options = {}) {\n        // ignore playback requests while paused\n        if (this.state.muted) { return; }\n        \n        // add to playlist\n        let id = Math.random().toString(16).slice(2);\n        this.playlist.push({\n            id: id,\n            key: key,\n            playback: audioPlayback(audioBuffer, {\n                ...{\n                    start: 0,\n                    end: audioBuffer.duration,\n                    context: this.audioCtx\n                },\n                ...options\n            }, () => {\n                // remove played sound from playlist\n                this.playlist = this.playlist\n                    .filter(s => s.id != id);\n            })\n        });\n    }\n\n    stopPlayback(key) {\n        this.playlist = this.playlist\n        .filter(s => {\n            let targetBuffer = s.key === key;\n            if (targetBuffer) {\n                s.playback.pause();\n            }\n            return targetBuffer;\n        })\n    }\n\n    // stop playlist\n    stopPlaylist() {\n      this.playlist\n      .forEach(s => this.stopPlayback(s.key))\n    }\n\n    // update game state\n    setState(state) {\n        this.state = {\n            ...this.state,\n            ...{\n                prev: this.state.current\n            },\n            ...state,\n        };\n    }\n\n    // request new frame\n    // wraps requestAnimationFrame.\n    requestFrame(next, resumed) {\n        let now = Date.now();\n        this.frame = {\n            count: requestAnimationFrame(next),\n            time: now,\n            rate: resumed ? 0 : now - this.frame.time,\n            scale: this.screen.scale * this.frame.rate * 0.01\n        };\n    }\n\n    // cancel frame\n    // wraps cancelAnimationFrame.\n    cancelFrame() {\n        cancelAnimationFrame(this.frame.count);\n    }\n}\n\nexport default Game;","import Game from './main.js';\n\nconst root = document.getElementById('root');\nconst config = {\n    settings: {\n        name: 'tetris',\n        tickRate: 30,\n        rows: 20,\n        columns: 10\n    },\n    colors: {\n        backgroundColor: \"#000\",\n        boardColor: \"#63D471\",\n        block1: \"#96c8ef\",\n        block2: \"#e76b93\",\n        block3: \"#ffde55\",\n        block4: \"#70efef\",\n        block5: \"#ffcf30\",\n        block6: \"pink\"\n    },\n    images: {\n        \"block1\": \"https://i.imgur.com/lUPWv0E.png\",\n        \"block2\": \"https://i.imgur.com/D6of24y.png\",\n        \"block3\": \"https://i.imgur.com/LmfnfFQ.png\",\n        \"block4\": \"https://i.imgur.com/StPlrV0.png\",\n        \"block5\": \"https://i.imgur.com/X7nmGWr.png\",\n        \"block6\": \"https://i.imgur.com/v03iKA8.png\"\n    },\n    sounds: {\n        backgroundMusic: \"https://objects.koji-cdn.com/eedc4ffb-7d04-464e-8c92-f5291d76f048/TetrisSalsa.mp3\",\n        clearSound: \"https://objects.koji-cdn.com/eedc4ffb-7d04-464e-8c92-f5291d76f048/sparkle.mp3\",\n        dropSound: \"https://objects.koji-cdn.com/eedc4ffb-7d04-464e-8c92-f5291d76f048/whoosh3.mp3\"\n    }\n};\n\n\nconst game = new Game(root, config);\n\ngame.load();","var OVERLAY_ID = '__parcel__error__overlay__';\n\nvar OldModule = module.bundle.Module;\n\nfunction Module(moduleName) {\n  OldModule.call(this, moduleName);\n  this.hot = {\n    data: module.bundle.hotData,\n    _acceptCallbacks: [],\n    _disposeCallbacks: [],\n    accept: function (fn) {\n      this._acceptCallbacks.push(fn || function () {});\n    },\n    dispose: function (fn) {\n      this._disposeCallbacks.push(fn);\n    }\n  };\n\n  module.bundle.hotData = null;\n}\n\nmodule.bundle.Module = Module;\nvar checkedAssets, assetsToAccept;\n\nvar parent = module.bundle.parent;\nif ((!parent || !parent.isParcelRequire) && typeof WebSocket !== 'undefined') {\n  var hostname = process.env.HMR_HOSTNAME || location.hostname;\n  var protocol = location.protocol === 'https:' ? 'wss' : 'ws';\n  var ws = new WebSocket(protocol + '://' + hostname + ':' + process.env.HMR_PORT + '/');\n  ws.onmessage = function(event) {\n    checkedAssets = {};\n    assetsToAccept = [];\n\n    var data = JSON.parse(event.data);\n\n    if (data.type === 'update') {\n      var handled = false;\n      data.assets.forEach(function(asset) {\n        if (!asset.isNew) {\n          var didAccept = hmrAcceptCheck(global.parcelRequire, asset.id);\n          if (didAccept) {\n            handled = true;\n          }\n        }\n      });\n\n      // Enable HMR for CSS by default.\n      handled = handled || data.assets.every(function(asset) {\n        return asset.type === 'css' && asset.generated.js;\n      });\n\n      if (handled) {\n        console.clear();\n\n        data.assets.forEach(function (asset) {\n          hmrApply(global.parcelRequire, asset);\n        });\n\n        assetsToAccept.forEach(function (v) {\n          hmrAcceptRun(v[0], v[1]);\n        });\n      } else if (location.reload) { // `location` global exists in a web worker context but lacks `.reload()` function.\n        location.reload();\n      }\n    }\n\n    if (data.type === 'reload') {\n      ws.close();\n      ws.onclose = function () {\n        location.reload();\n      }\n    }\n\n    if (data.type === 'error-resolved') {\n      console.log('[parcel]  Error resolved');\n\n      removeErrorOverlay();\n    }\n\n    if (data.type === 'error') {\n      console.error('[parcel]   ' + data.error.message + '\\n' + data.error.stack);\n\n      removeErrorOverlay();\n\n      var overlay = createErrorOverlay(data);\n      document.body.appendChild(overlay);\n    }\n  };\n}\n\nfunction removeErrorOverlay() {\n  var overlay = document.getElementById(OVERLAY_ID);\n  if (overlay) {\n    overlay.remove();\n  }\n}\n\nfunction createErrorOverlay(data) {\n  var overlay = document.createElement('div');\n  overlay.id = OVERLAY_ID;\n\n  // html encode message and stack trace\n  var message = document.createElement('div');\n  var stackTrace = document.createElement('pre');\n  message.innerText = data.error.message;\n  stackTrace.innerText = data.error.stack;\n\n  overlay.innerHTML = (\n    '<div style=\"background: black; font-size: 16px; color: white; position: fixed; height: 100%; width: 100%; top: 0px; left: 0px; padding: 30px; opacity: 0.85; font-family: Menlo, Consolas, monospace; z-index: 9999;\">' +\n      '<span style=\"background: red; padding: 2px 4px; border-radius: 2px;\">ERROR</span>' +\n      '<span style=\"top: 2px; margin-left: 5px; position: relative;\"></span>' +\n      '<div style=\"font-size: 18px; font-weight: bold; margin-top: 20px;\">' + message.innerHTML + '</div>' +\n      '<pre>' + stackTrace.innerHTML + '</pre>' +\n    '</div>'\n  );\n\n  return overlay;\n\n}\n\nfunction getParents(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return [];\n  }\n\n  var parents = [];\n  var k, d, dep;\n\n  for (k in modules) {\n    for (d in modules[k][1]) {\n      dep = modules[k][1][d];\n      if (dep === id || (Array.isArray(dep) && dep[dep.length - 1] === id)) {\n        parents.push(k);\n      }\n    }\n  }\n\n  if (bundle.parent) {\n    parents = parents.concat(getParents(bundle.parent, id));\n  }\n\n  return parents;\n}\n\nfunction hmrApply(bundle, asset) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (modules[asset.id] || !bundle.parent) {\n    var fn = new Function('require', 'module', 'exports', asset.generated.js);\n    asset.isNew = !modules[asset.id];\n    modules[asset.id] = [fn, asset.deps];\n  } else if (bundle.parent) {\n    hmrApply(bundle.parent, asset);\n  }\n}\n\nfunction hmrAcceptCheck(bundle, id) {\n  var modules = bundle.modules;\n  if (!modules) {\n    return;\n  }\n\n  if (!modules[id] && bundle.parent) {\n    return hmrAcceptCheck(bundle.parent, id);\n  }\n\n  if (checkedAssets[id]) {\n    return;\n  }\n  checkedAssets[id] = true;\n\n  var cached = bundle.cache[id];\n\n  assetsToAccept.push([bundle, id]);\n\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    return true;\n  }\n\n  return getParents(global.parcelRequire, id).some(function (id) {\n    return hmrAcceptCheck(global.parcelRequire, id)\n  });\n}\n\nfunction hmrAcceptRun(bundle, id) {\n  var cached = bundle.cache[id];\n  bundle.hotData = {};\n  if (cached) {\n    cached.hot.data = bundle.hotData;\n  }\n\n  if (cached && cached.hot && cached.hot._disposeCallbacks.length) {\n    cached.hot._disposeCallbacks.forEach(function (cb) {\n      cb(bundle.hotData);\n    });\n  }\n\n  delete bundle.cache[id];\n  bundle(id);\n\n  cached = bundle.cache[id];\n  if (cached && cached.hot && cached.hot._acceptCallbacks.length) {\n    cached.hot._acceptCallbacks.forEach(function (cb) {\n      cb();\n    });\n    return true;\n  }\n}\n"]}